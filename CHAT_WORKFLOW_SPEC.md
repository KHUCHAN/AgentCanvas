# CHAT_WORKFLOW_SPEC â€” ëŒ€í™”í˜• ì›Œí¬í”Œë¡œìš° ì „í™˜ ì„¤ê³„

> **ì‘ì„±ì¼**: 2026-02-19
> **í•µì‹¬ ë³€ê²½**: ìš°ì¸¡ íŒ¨ë„ì˜ Task/Run/Inspector íƒ­ì„ **Chat íŒ¨ë„** í•˜ë‚˜ë¡œ í†µí•©
> **ì² í•™**: ì‚¬ìš©ìëŠ” Orchestratorì™€ **ëŒ€í™”**í•œë‹¤. ëŒ€í™” ì†ì—ì„œ ì‘ì—…ì´ ì •ì˜ë˜ê³ , í™•ì •ë˜ë©´ Taskê°€ ìƒì„±ë˜ì–´ Kanban/Scheduleë¡œ í˜ëŸ¬ê°„ë‹¤.

---

## 1. í˜„ì¬ vs ë³€ê²½

### 1.1 í˜„ì¬ êµ¬ì¡° (íê¸° ëŒ€ìƒ)

```
Right Panel Tabs:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ Library  â”‚ Inspector â”‚ Task â”‚ Run â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

ë¬¸ì œ:
- Task íƒ­: form ê¸°ë°˜ (textarea + priority select + Submit Work ë²„íŠ¼)
- Run íƒ­: ì‹¤í–‰ ë¡œê·¸ ë‚˜ì—´ (RunEvents ìŠ¤íŠ¸ë¦¬ë°)
- Inspector íƒ­: ë…¸ë“œ ìƒì„¸ (AgentDetailModalê³¼ ì¤‘ë³µ)
- ì‚¬ìš©ì ì…ì¥: 4ê°œ íƒ­ ì „í™˜í•˜ë©° ì‘ì—… â†’ ë¹„ì§ê´€ì 
- Task vs Run ì°¨ì´ ë¶ˆëª…í™• (CODE_REVIEW2 USR-5)
```

### 1.2 ë³€ê²½ êµ¬ì¡°

```
Right Panel Tabs:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ Library  â”‚ Chat â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

Chat íŒ¨ë„ í•˜ë‚˜ê°€ ê¸°ì¡´ Task + Run + Inspector ì—­í• ì„ ì „ë¶€ ëŒ€ì²´:
- ëŒ€í™”ë¡œ ì‘ì—… ì§€ì‹œ â†’ Task íƒ­ ëŒ€ì²´
- ëŒ€í™” ì¤‘ ì‹¤í–‰ ìƒíƒœ ì¸ë¼ì¸ í‘œì‹œ â†’ Run íƒ­ ëŒ€ì²´
- ë…¸ë“œ í´ë¦­ ì‹œ Chatì— ì»¨í…ìŠ¤íŠ¸ ì¹´ë“œ ì‚½ì… â†’ Inspector ëŒ€ì²´
```

---

## 2. í•µì‹¬ í”Œë¡œìš°

### 2.1 ì „ì²´ íë¦„

```
ì‚¬ìš©ì â”€â”€â”€â”€ ëŒ€í™” â”€â”€â”€â”€â†’ Orchestrator (ì‚´ì•„ìˆëŠ” PM)
                          â”‚
                    [ì˜ë„ íŒŒì•…]
                          â”‚
                    ì •ë³´ ë¶€ì¡±? â”€â”€â”€â”€ Yes â†’ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸
                          â”‚                    â”‚
                         No              ì‚¬ìš©ì ë‹µë³€
                          â”‚                    â”‚
                          â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    [Task ì„¤ê³„ & ë¶„ë°°]
                          â”‚
                    Agent ë¶€ì¡±? â”€â”€â”€â”€ Yes â†’ ìƒˆ Agent ìƒì„± ì œì•ˆ
                          â”‚                    â”‚
                         No              ì‚¬ìš©ì ìŠ¹ì¸
                          â”‚                    â”‚
                          â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â—€â”€â”€ WorkPlan ì œì•ˆ â”€â”€â–¶
                          â”‚
              ì‚¬ìš©ì: "ì¢‹ì•„, ì§„í–‰í•´"
                          â”‚
                    [Task ìƒì„± â†’ Agent í• ë‹¹ â†’ ì‹¤í–‰]
                          â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â–¼        â–¼        â–¼
              Kanban   Schedule   Graph
             (ì¹´ë“œìƒì„±) (íƒ€ì„ë¼ì¸) (ë…¸ë“œí™œì„±)
                          â”‚
              â”Œâ”€â”€â”€ Supervision Loop (ê³„ì† ê°ì‹œ) â”€â”€â”€â”
              â”‚                                    â”‚
              â”‚  Agent ì •ìƒ? â†’ ì§„í–‰ ë³´ê³             â”‚
              â”‚  Agent ë©ˆì¶¤? â†’ ì¬ì‹œì‘/ì¬í• ë‹¹         â”‚
              â”‚  Task ì‹¤íŒ¨?  â†’ ìˆ˜ì • Task ìƒì„±       â”‚
              â”‚  Agent ë¶€ì¡±? â†’ ìƒˆ Agent ìƒì„±        â”‚
              â”‚  ë¹„ìš© ì´ˆê³¼?  â†’ Backend ì „í™˜         â”‚
              â”‚  ì •ë³´ í•„ìš”?  â†’ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸ â­    â”‚
              â”‚    (blocking â†’ Task ì¼ì‹œì •ì§€)       â”‚
              â”‚    (preferred â†’ ê³„ì† ì§„í–‰)          â”‚
              â”‚                                    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              Chatì— ì§„í–‰ìƒíƒœ ì‹¤ì‹œê°„ í‘œì‹œ
                          â”‚
                  [Agent ì‘ì—… ì œì¶œ]
                          â”‚
              â”Œâ”€â”€â”€ Review Gate (í•„ìˆ˜) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                                    â”‚
              â”‚  Orchestratorê°€ ê²°ê³¼ë¬¼ ê²€ì¦:         â”‚
              â”‚  âœ… ìŠ¹ì¸ â†’ Task "done"              â”‚
              â”‚  ğŸ”„ ìˆ˜ì •ìš”ì²­ â†’ Agentì— í”¼ë“œë°±        â”‚
              â”‚     â†’ Agent ì¬ì‘ì—… â†’ ë‹¤ì‹œ Review    â”‚
              â”‚  âŒ ë°˜ë ¤ â†’ ë‹¤ë¥¸ Agentì— ì¬í• ë‹¹       â”‚
              â”‚     or ì‚¬ìš©ìì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜        â”‚
              â”‚                                    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    [ëª¨ë“  Task ìŠ¹ì¸ ì™„ë£Œ]
                          â”‚
                    [ì „ì²´ ì™„ë£Œ ë³´ê³ ]
                          â–¼
              ì‚¬ìš©ì: "ê²°ê³¼ ë³´ì—¬ì¤˜" / ë‹¤ìŒ ëŒ€í™”
```

### 2.2 ëŒ€í™” ì˜ˆì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Orchestrator                              â”‚
â”‚ íŒ€ì´ ì¤€ë¹„ëìŠµë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?        â”‚
â”‚                                              â”‚
â”‚ ğŸ‘¤ ì‚¬ìš©ì                                    â”‚
â”‚ ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬íŒ©í† ë§í•˜ê³  í…ŒìŠ¤íŠ¸ ì¶”ê°€í•´ì¤˜       â”‚
â”‚                                              â”‚
â”‚ ğŸ¤– Orchestrator                              â”‚
â”‚ ë¶„ì„í–ˆìŠµë‹ˆë‹¤. ì•„ë˜ ê³„íšì„ ì œì•ˆí•©ë‹ˆë‹¤:           â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ ğŸ“‹ Work Plan â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ 1. Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ (LoginForm,       â”‚ â”‚
â”‚ â”‚    AuthProvider) â”€â”€â”€â”€ Frontend Dev/Codex  â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ 2. ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§ â”€â”€ Backend Dev/     â”‚ â”‚
â”‚ â”‚    Claude                                â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ 3. Unit + E2E í…ŒìŠ¤íŠ¸ ì‘ì„± â”€â”€ QA/Codex    â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ ì˜ˆìƒ ì†Œìš”: ~25ë¶„                          â”‚ â”‚
â”‚ â”‚ ì˜ˆìƒ ë¹„ìš©: ~$1.80                        â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ [ìˆ˜ì •í•˜ê¸°]  [â–¶ ì§„í–‰]  [ì·¨ì†Œ]              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ ğŸ‘¤ ì‚¬ìš©ì                                    â”‚
â”‚ 2ë²ˆì€ priority highë¡œ í•´ì¤˜                    â”‚
â”‚                                              â”‚
â”‚ ğŸ¤– Orchestrator                              â”‚
â”‚ 2ë²ˆ "ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§"ì„ Highë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤. â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ ğŸ“‹ Work Plan (ìˆ˜ì •ë¨) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ â”€â”€ Medium         â”‚ â”‚
â”‚ â”‚ 2. ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§ â”€â”€ ğŸ”´ High        â”‚ â”‚
â”‚ â”‚ 3. Unit + E2E í…ŒìŠ¤íŠ¸ â”€â”€ Medium           â”‚ â”‚
â”‚ â”‚                                          â”‚ â”‚
â”‚ â”‚ [ìˆ˜ì •í•˜ê¸°]  [â–¶ ì§„í–‰]  [ì·¨ì†Œ]              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ ğŸ‘¤ ì‚¬ìš©ì                                    â”‚
â”‚ ì§„í–‰í•´                                       â”‚
â”‚                                              â”‚
â”‚ ğŸ¤– Orchestrator                              â”‚
â”‚ 3ê°œ Taskë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰ì„ ì‹œì‘í•©ë‹ˆë‹¤.          â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ ğŸ”„ Task #1 ì‹¤í–‰ ì¤‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬                      â”‚ â”‚
â”‚ â”‚ Agent: Frontend Dev (Codex)             â”‚ â”‚
â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 58%                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ â³ Task #2 ëŒ€ê¸° ì¤‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§ (ğŸ”´ High)            â”‚ â”‚
â”‚ â”‚ Agent: Backend Dev (Claude)             â”‚ â”‚
â”‚ â”‚ ì˜ì¡´: Task #1 ì™„ë£Œ í›„ ì‹œì‘               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ â“ Agent ì§ˆë¬¸ (ì§„í–‰ ì¤‘) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Task #1: Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬             â”‚ â”‚
â”‚ â”‚ ğŸ‘¤ Frontend Dev (Codex)                 â”‚ â”‚
â”‚ â”‚ "ë¡œê·¸ì¸ validationì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í• ê¹Œìš”,   â”‚ â”‚
â”‚ â”‚  Submit ì‹œì ì—ë§Œ í• ê¹Œìš”?"                â”‚ â”‚
â”‚ â”‚ ğŸŸ¡ ë‹µë³€ ì—†ìœ¼ë©´ "ì‹¤ì‹œê°„ ê²€ì¦"ìœ¼ë¡œ ì§„í–‰     â”‚ â”‚
â”‚ â”‚ [ì‹¤ì‹œê°„ ê²€ì¦]  [Submit ì‹œ ê²€ì¦]           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ ğŸ‘¤ ì‚¬ìš©ì                                    â”‚
â”‚ ì‹¤ì‹œê°„ìœ¼ë¡œ í•´ì¤˜                                â”‚
â”‚                                              â”‚
â”‚ ğŸ¤– Orchestrator                              â”‚
â”‚ Frontend Devì— ì „ë‹¬í–ˆìŠµë‹ˆë‹¤.                   â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ ğŸ” Task #1 Review ì¤‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬                      â”‚ â”‚
â”‚ â”‚ Agent: Frontend Dev (Codex)             â”‚ â”‚
â”‚ â”‚ Orchestratorê°€ ê²°ê³¼ë¥¼ ê²€ì¦í•˜ê³  ìˆìŠµë‹ˆë‹¤... â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€ âœ… Task #1 ìŠ¹ì¸ ì™„ë£Œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬                      â”‚ â”‚
â”‚ â”‚ ê²€ì¦: âœ… ì»´íŒŒì¼ Â· âœ… í…ŒìŠ¤íŠ¸ Â· âœ… ë²”ìœ„    â”‚ â”‚
â”‚ â”‚ 4ê°œ íŒŒì¼ ë³€ê²½, 2ë¶„ 32ì´ˆ                  â”‚ â”‚
â”‚ â”‚ [diff ë³´ê¸°]  [ë˜ëŒë¦¬ê¸°]                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚ ...                                          â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ë©”ì‹œì§€ ì…ë ¥...          [ğŸ“] [ğŸ¤] [â¤]  â”‚ â”‚
â”‚ â”‚ + âˆ¨ Planning  âˆ¨ Claude    ğŸ™   â¤       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Chat ë©”ì‹œì§€ íƒ€ì… ì‹œìŠ¤í…œ

### 3.1 ë©”ì‹œì§€ ì¢…ë¥˜

```typescript
export type ChatMessageRole = "user" | "orchestrator" | "system";

export type ChatMessageContent =
  | { kind: "text"; text: string }
  | { kind: "work_plan"; plan: WorkPlan }
  | { kind: "task_status"; taskId: string; status: TaskStatusUpdate }
  | { kind: "task_complete"; taskId: string; summary: TaskCompleteSummary }
  | { kind: "run_event"; event: RunEvent }
  | { kind: "node_context"; nodeId: string; nodeType: string; data: Record<string, unknown> }
  | { kind: "error"; message: string; recoverable: boolean }
  | { kind: "cost_alert"; backendId: string; usage: BackendUsageSummary }
  | { kind: "file_diff"; files: FileDiffEntry[] }
  | { kind: "task_review"; review: TaskReviewResult }
  | { kind: "user_query"; query: MidExecutionQuery }
  | { kind: "user_query_response"; queryId: string; answer: string }
  | { kind: "approval_request"; requestId: string; description: string; options: string[] };

export interface ChatMessage {
  id: string;
  role: ChatMessageRole;
  content: ChatMessageContent[];
  timestamp: number;
  metadata?: {
    runId?: string;
    taskIds?: string[];
    backendId?: string;
    model?: string;
    tokens?: { input: number; output: number };
  };
}
```

### 3.2 WorkPlan (ëŒ€í™” â†’ Task ì „í™˜ì )

```typescript
export interface WorkPlan {
  id: string;
  status: "draft" | "confirmed" | "executing" | "completed" | "canceled";

  items: WorkPlanItem[];

  estimatedDuration?: string;
  estimatedCost?: number;
}

export interface WorkPlanItem {
  index: number;
  title: string;
  description?: string;

  // Agent í• ë‹¹
  assignedAgentId: string;
  assignedAgentName: string;
  assignedBackend: Exclude<CliBackendId, "auto">;
  assignedModel?: string;

  // ì˜µì…˜
  priority: "high" | "medium" | "low";
  deps: number[];  // ì˜ì¡´í•˜ëŠ” item index

  // í™•ì • í›„ ë§¤í•‘
  taskId?: string;  // ìƒì„±ëœ Taskì˜ ID
}
```

### 3.3 Chat â†” Task ì „í™˜ ë¡œì§

```
[WorkPlan status: "draft"]
  ì‚¬ìš©ìê°€ ìˆ˜ì • ìš”ì²­ â†’ Orchestratorê°€ plan ì—…ë°ì´íŠ¸ â†’ ë‹¤ì‹œ draft í‘œì‹œ
  ì‚¬ìš©ìê°€ "ì§„í–‰" â†’ status: "confirmed"
                      â”‚
                      â–¼
              [Task ìƒì„± íŠ¸ë¦¬ê±°]
              ê° WorkPlanItem â†’ Task ìƒì„±
              item.taskId = ìƒì„±ëœ taskId
                      â”‚
                      â–¼
              [WorkPlan status: "executing"]
              Task ì§„í–‰ ìƒíƒœê°€ Chatì— ì¸ë¼ì¸ í‘œì‹œ
              ë™ì‹œì— Kanban ë³´ë“œì— ì¹´ë“œ ìƒì„±
              ë™ì‹œì— Schedule ë·°ì— íƒ€ì„ë¼ì¸ ìƒì„±
                      â”‚
                      â–¼
              [Agent ì‘ì—… ì™„ë£Œ â†’ Task "in_review"]
              Kanban: In Review ì»¬ëŸ¼ìœ¼ë¡œ ì´ë™
              Orchestratorê°€ ê²°ê³¼ë¬¼ ê²€ì¦ (Review Gate)
                      â”‚
                â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”
                â–¼     â–¼     â–¼
             ìŠ¹ì¸   ìˆ˜ì •   ë°˜ë ¤
              â”‚    ìš”ì²­    â”‚
              â”‚     â”‚     ì¬í• ë‹¹
              â”‚   Agent   â†’ Todo
              â”‚   ì¬ì‘ì—…
              â”‚     â”‚
              â”‚   ë‹¤ì‹œ Review
              â”‚     â”‚
              â—„â”€â”€â”€â”€â”€â”˜
                      â”‚
              [ëª¨ë“  Task ìŠ¹ì¸ ì™„ë£Œ]
              WorkPlan status: "completed"
              Orchestratorê°€ ì™„ë£Œ ìš”ì•½ ë©”ì‹œì§€ ì „ì†¡
```

---

## 4. Right Panel êµ¬ì¡° ë³€ê²½

### 4.1 íƒ­ êµ¬ì¡°

```
ê¸°ì¡´: Library | Inspector | Task | Run (4íƒ­)
ë³€ê²½: Library | Chat (2íƒ­)
```

### 4.2 Chat íŒ¨ë„ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€ Chat Panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚  â”Œâ”€ Messages Area (scrollable) â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚  [system] íŒ€ì´ ì¤€ë¹„ëìŠµë‹ˆë‹¤         â”‚  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚  [user] ë¡œê·¸ì¸ ë¦¬íŒ©í† ë§í•´ì¤˜         â”‚  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚  [orchestrator] ê³„íš ì œì•ˆ...        â”‚  â”‚
â”‚  â”‚    â”Œâ”€ WorkPlan Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚    â”‚ ...                        â”‚  â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚  [orchestrator] Task #1 ì§„í–‰ ì¤‘    â”‚  â”‚
â”‚  â”‚    â”Œâ”€ TaskStatus Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 78%             â”‚  â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€ Input Area â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [ë©”ì‹œì§€ ì…ë ¥...]                    â”‚  â”‚
â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚ [+]  [âˆ¨ Mode]  [âˆ¨ Backend]  [â¤]   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Input Area ìƒì„¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...              [â¤]  â”‚
â”‚                                         â”‚
â”‚ [+] [âˆ¨ Planning] [âˆ¨ Claude â–¸ sonnet]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[+] ë²„íŠ¼: ì²¨ë¶€ ë©”ë‰´
  â”œâ”€â”€ ğŸ“„ íŒŒì¼ ì°¸ì¡° (@íŒŒì¼ê²½ë¡œ)
  â”œâ”€â”€ ğŸ–¼ï¸ ìŠ¤í¬ë¦°ìƒ·
  â””â”€â”€ ğŸ“‹ í´ë¦½ë³´ë“œ ë¶™ì—¬ë„£ê¸°

[âˆ¨ Planning] : ëŒ€í™” ëª¨ë“œ ì„ íƒ
  â”œâ”€â”€ Planning (ê¸°ë³¸) â€” ê³„íš ìˆ˜ë¦½ í›„ í™•ì¸ ë°›ê³  ì‹¤í–‰
  â”œâ”€â”€ Direct â€” ì¦‰ì‹œ ì‹¤í–‰ (í™•ì¸ ì—†ì´)
  â””â”€â”€ Review â€” ì‹¤í–‰ ì—†ì´ ë¶„ì„ë§Œ

[âˆ¨ Claude â–¸ sonnet] : Orchestrator ë°±ì—”ë“œ + ëª¨ë¸
  â”œâ”€â”€ Claude â–¸ sonnet-4.5
  â”œâ”€â”€ Claude â–¸ haiku-4.5
  â”œâ”€â”€ Codex â–¸ codex-1
  â”œâ”€â”€ Gemini â–¸ 2.5-pro
  â””â”€â”€ Gemini â–¸ 2.5-flash
```

---

## 5. ê¸°ì¡´ ê¸°ëŠ¥ í†µí•© ë§¤í•‘

### 5.1 Task íŒ¨ë„ â†’ Chat í†µí•©

| ê¸°ì¡´ TaskPanel ê¸°ëŠ¥ | Chat í†µí•© ë°©ì‹ |
|---------------------|---------------|
| Work í”„ë¡¬í”„íŠ¸ ì…ë ¥ (textarea) | Chat ì…ë ¥ì°½ì—ì„œ ìì—°ì–´ë¡œ ì…ë ¥ |
| Priority ì„ íƒ (select) | ëŒ€í™” ì¤‘ "priority highë¡œ" ë˜ëŠ” WorkPlan ì¹´ë“œì—ì„œ í´ë¦­ ë³€ê²½ |
| Agent í• ë‹¹ (assignTo select) | Orchestratorê°€ ìë™ í• ë‹¹, ì‚¬ìš©ìê°€ ëŒ€í™”ë¡œ ë³€ê²½ ê°€ëŠ¥ |
| Submit Work ë²„íŠ¼ | WorkPlanì˜ [â–¶ ì§„í–‰] ë²„íŠ¼ |
| Active Tasks ëª©ë¡ | Chatì— TaskStatus ì¹´ë“œë¡œ ì‹¤ì‹œê°„ í‘œì‹œ |
| Task History | Chat ìŠ¤í¬ë¡¤ ê¸°ë¡ ìì²´ê°€ íˆìŠ¤í† ë¦¬ |

### 5.2 Run íŒ¨ë„ â†’ Chat í†µí•©

| ê¸°ì¡´ RunPanel ê¸°ëŠ¥ | Chat í†µí•© ë°©ì‹ |
|---------------------|---------------|
| Flow ì‹¤í–‰ | WorkPlan í™•ì • ì‹œ ìë™ ì‹¤í–‰ |
| Backend ì„ íƒ | Input Areaì˜ Backend selector + AGENT_TEAM_BUILD_SPECì˜ ìë™ í• ë‹¹ |
| Run Events ìŠ¤íŠ¸ë¦¬ë° | Chatì— `task_status` ì¹´ë“œë¡œ ì¸ë¼ì¸ í‘œì‹œ |
| Run History | Chat ëŒ€í™” ê¸°ë¡ = Run History |
| Stop Run | ëŒ€í™”ë¡œ "ë©ˆì¶°" ë˜ëŠ” TaskStatus ì¹´ë“œì˜ [â¹] ë²„íŠ¼ |
| Run Log ì—´ê¸° | TaskComplete ì¹´ë“œì˜ [ë¡œê·¸ ë³´ê¸°] ë²„íŠ¼ |
| Replay Run | ëŒ€í™”ë¡œ "ë‹¤ì‹œ ì‹¤í–‰í•´ì¤˜" |
| Timeline | Chatì—ì„œëŠ” ìš”ì•½ë§Œ, ìƒì„¸ëŠ” Schedule ë·° |

### 5.3 Inspector â†’ Chat í†µí•©

| ê¸°ì¡´ Inspector ê¸°ëŠ¥ | Chat í†µí•© ë°©ì‹ |
|---------------------|---------------|
| Node overview | Graphì—ì„œ ë…¸ë“œ í´ë¦­ â†’ Chatì— `node_context` ì¹´ë“œ ì‚½ì… |
| JSON view | `node_context` ì¹´ë“œ í™•ì¥ ì‹œ JSON í† ê¸€ |
| Variables | `node_context` ì¹´ë“œ ë‚´ Variables ì„¹ì…˜ |
| Edge info | Edge í´ë¦­ â†’ Chatì— edge context ì¹´ë“œ |
| Agent detail | Agent ë”ë¸”í´ë¦­ â†’ AgentDetailModal (ê¸°ì¡´ ìœ ì§€) |

---

## 6. íƒ€ì… ë³€ê²½

### 6.1 ì‹ ê·œ íƒ€ì…

**íŒŒì¼**: `webview-ui/src/messaging/protocol.ts`, `extension/src/types.ts`

```typescript
// === Chat ë©”ì‹œì§€ ===
export interface ChatMessage { ... }          // Â§3.1 ì°¸ì¡°
export type ChatMessageContent = { ... };     // Â§3.1 ì°¸ì¡°
export interface WorkPlan { ... }             // Â§3.2 ì°¸ì¡°
export interface WorkPlanItem { ... }         // Â§3.2 ì°¸ì¡°

// === Task ì§„í–‰ ìƒíƒœ ===
export interface TaskStatusUpdate {
  taskId: string;
  title: string;
  status: Task["status"];
  progress: number;           // 0.0~1.0
  agentName: string;
  backendId: string;
  message?: string;           // "LoginForm.tsx ë¶„ë¦¬ ì¤‘..."
}

export interface TaskCompleteSummary {
  taskId: string;
  title: string;
  durationMs: number;
  changedFiles: string[];
  diffSummary?: string;       // "+120 -45 across 4 files"
  cost?: number;
}

export interface FileDiffEntry {
  path: string;
  additions: number;
  deletions: number;
  preview?: string;           // ì²˜ìŒ 5ì¤„
}

// === ì‹¤í–‰ ì¤‘ ì‚¬ìš©ì ì§ˆì˜ (Mid-Execution Query) ===
export type QueryUrgency = "blocking" | "preferred" | "optional";

export interface MidExecutionQuery {
  queryId: string;
  taskId: string;                      // ì–´ë–¤ Taskì—ì„œ ë°œìƒí•œ ì§ˆë¬¸ì¸ê°€
  agentId: string;                     // ì–´ë–¤ Agentê°€ ìš”ì²­í–ˆëŠ”ê°€
  agentName: string;
  question: string;                    // ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ì§ˆë¬¸
  context: string;                     // ì§ˆë¬¸ ë°°ê²½ (Agentê°€ ì™œ ì´ê±¸ ë¬¼ì–´ë³´ëŠ”ì§€)
  urgency: QueryUrgency;              // blocking: Task ì¼ì‹œì •ì§€, preferred: ê³„ì† ì§„í–‰ ê°€ëŠ¥, optional: ë¬´ì‹œ ê°€ëŠ¥
  suggestedOptions?: string[];         // Agentê°€ ì œì•ˆí•˜ëŠ” ì„ íƒì§€ (ìˆìœ¼ë©´)
  defaultAnswer?: string;              // ê¸°ë³¸ê°’ (ì‚¬ìš©ì ë¬´ì‘ë‹µ ì‹œ ì‚¬ìš©)
  timeoutMs?: number;                  // ë‹µë³€ ëŒ€ê¸° ì‹œê°„ (ê¸°ë³¸ 60000ms, blockingë§Œ)
  timestamp: number;

  // ì‘ë‹µ í›„ ì±„ì›Œì§
  answer?: string;
  answeredAt?: number;
  answeredBy?: "user" | "orchestrator"; // Orchestratorê°€ ëŒ€ì‹  ë‹µë³€í•  ìˆ˜ë„ ìˆìŒ
}

// === Review Gate ===
export type TaskReviewDecision = "approved" | "revision_needed" | "rejected";

export interface TaskReviewResult {
  taskId: string;
  title: string;
  decision: TaskReviewDecision;
  reviewedBy: "orchestrator";        // í•­ìƒ Orchestratorê°€ ê²€ì¦
  reviewTimestamp: number;

  // ìŠ¹ì¸ ì‹œ
  approvalSummary?: string;          // "ì½”ë“œ í’ˆì§ˆ ì–‘í˜¸, í…ŒìŠ¤íŠ¸ í†µê³¼"
  changedFiles?: string[];

  // ìˆ˜ì • ìš”ì²­ ì‹œ
  revisionFeedback?: string;         // "ì—ëŸ¬ í•¸ë“¤ë§ ëˆ„ë½, retry ë¡œì§ ì¶”ê°€ í•„ìš”"
  revisionItems?: string[];          // êµ¬ì²´ì  ìˆ˜ì • í¬ì¸íŠ¸
  revisionCount?: number;            // í˜„ì¬ê¹Œì§€ ìˆ˜ì • íšŸìˆ˜

  // ë°˜ë ¤ ì‹œ
  rejectionReason?: string;          // "ìš”êµ¬ì‚¬í•­ ë¯¸ì¶©ì¡±"
  reassignTo?: string;               // ë‹¤ë¥¸ Agent ID (ìë™ ì¬í• ë‹¹ ì‹œ)
}

// === Task ìƒíƒœ í™•ì¥ ===
// ê¸°ì¡´: "todo" | "running" | "blocked" | "done"
// ë³€ê²½: "todo" | "running" | "blocked" | "in_review" | "done"
//
// in_review: Agentê°€ ê²°ê³¼ë¥¼ ì œì¶œí–ˆìœ¼ë‚˜ Orchestrator ìŠ¹ì¸ ëŒ€ê¸° ì¤‘
// done: Orchestratorê°€ ìŠ¹ì¸í•œ ìµœì¢… ì™„ë£Œ ìƒíƒœ
export type TaskStatus = "todo" | "running" | "blocked" | "in_review" | "done";
```

### 6.2 ì‹ ê·œ ë©”ì‹œì§€ (Extension â†” Webview)

```typescript
// Webview â†’ Extension
| RequestMessage<"CHAT_SEND", {
    content: string;
    mode: "planning" | "direct" | "review";
    backendId: Exclude<CliBackendId, "auto">;
    modelId?: string;
    attachments?: Array<{ type: "file" | "image"; path: string }>;
  }>
| RequestMessage<"WORK_PLAN_CONFIRM", { planId: string }>
| RequestMessage<"WORK_PLAN_MODIFY", { planId: string; modifications: WorkPlanModification[] }>
| RequestMessage<"WORK_PLAN_CANCEL", { planId: string }>
| RequestMessage<"TASK_STOP_FROM_CHAT", { taskId: string }>
| RequestMessage<"TASK_QUERY_RESPOND", {
    queryId: string;
    answer: string;
  }>
| RequestMessage<"CHAT_GET_HISTORY", { limit?: number; before?: string }>

// Extension â†’ Webview
| { type: "CHAT_MESSAGE"; payload: { message: ChatMessage } }
| { type: "CHAT_STREAM_CHUNK"; payload: { messageId: string; chunk: string } }
| { type: "WORK_PLAN_UPDATED"; payload: { plan: WorkPlan } }
| { type: "TASK_STATUS_UPDATE"; payload: { update: TaskStatusUpdate } }
| { type: "TASK_USER_QUERY"; payload: { query: MidExecutionQuery } }
| { type: "TASK_QUERY_AUTO_RESOLVED"; payload: { query: MidExecutionQuery; answer: string; source: string } }
| { type: "CHAT_HISTORY"; payload: { messages: ChatMessage[] } }
```

### 6.3 RightPanel mode ë³€ê²½

```typescript
// ê¸°ì¡´
type mode = "library" | "inspector" | "task" | "run";

// ë³€ê²½
type mode = "library" | "chat";
```

### 6.4 ì‚­ì œ ëŒ€ìƒ íƒ€ì…/Props

```typescript
// ì‚­ì œ: TaskPanelOptions (Chat ëŒ€í™”ë¡œ ëŒ€ì²´)
// ì‚­ì œ: RunPanelPropsì˜ ëŒ€ë¶€ë¶„ (Chatìœ¼ë¡œ í¡ìˆ˜)
// ì‚­ì œ: RightPanelì˜ inspector ê´€ë ¨ state (inspectorTab, agentInspectorTab)
```

---

## 7. íŒŒì¼ ë³€ê²½ ê³„íš

### 7.1 ì‹ ê·œ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `webview-ui/src/panels/ChatPanel.tsx` | Chat íŒ¨ë„ ë©”ì¸ ì»´í¬ë„ŒíŠ¸ |
| `webview-ui/src/panels/ChatInput.tsx` | ì…ë ¥ì°½ (ëª¨ë“œ ì„ íƒ, Backend ì„ íƒ, ì²¨ë¶€) |
| `webview-ui/src/panels/ChatMessageList.tsx` | ë©”ì‹œì§€ ëª©ë¡ (ìŠ¤í¬ë¡¤, ìë™ ìŠ¤í¬ë¡¤) |
| `webview-ui/src/components/WorkPlanCard.tsx` | WorkPlan ì¸ë¼ì¸ ì¹´ë“œ |
| `webview-ui/src/components/TaskStatusCard.tsx` | Task ì§„í–‰ ìƒíƒœ ì¸ë¼ì¸ ì¹´ë“œ |
| `webview-ui/src/components/TaskCompleteCard.tsx` | Task ì™„ë£Œ ìš”ì•½ ì¹´ë“œ |
| `webview-ui/src/components/NodeContextCard.tsx` | ë…¸ë“œ ì»¨í…ìŠ¤íŠ¸ ì¹´ë“œ (Inspector ëŒ€ì²´) |
| `webview-ui/src/components/FileDiffCard.tsx` | íŒŒì¼ ë³€ê²½ diff ì¹´ë“œ |
| `webview-ui/src/components/TaskReviewCard.tsx` | Review ê²°ê³¼ ì¹´ë“œ (ìŠ¹ì¸/ìˆ˜ì •ìš”ì²­/ë°˜ë ¤ í‘œì‹œ) |
| `webview-ui/src/components/QueryCard.tsx` | ì‹¤í–‰ ì¤‘ ì§ˆë¬¸ ì¹´ë“œ (blocking/preferred/optional) |
| `extension/src/services/chatOrchestrator.ts` | Chat â†’ Orchestrator â†’ Task ë¸Œë¦¿ì§€ |
| `extension/src/services/workPlanService.ts` | WorkPlan CRUD + í™•ì • â†’ Task ë³€í™˜ |
| `extension/src/services/reviewGate.ts` | Review Gate ë¡œì§ (ê²€ì¦ ê¸°ì¤€ í‰ê°€, ìë™ìŠ¹ì¸ íŒì •) |

### 7.2 ìˆ˜ì • íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `RightPanel.tsx` | íƒ­ì„ library / chat 2ê°œë¡œ ì¶•ì†Œ, inspectorÂ·taskÂ·run ê´€ë ¨ ì½”ë“œ ì œê±° |
| `App.tsx` | panelMode íƒ€ì… ë³€ê²½, Chat ê´€ë ¨ state ì¶”ê°€, Task/Run íŒ¨ë„ í˜¸ì¶œ ì œê±° |
| `protocol.ts` (ì–‘ìª½) | Chat ë©”ì‹œì§€ íƒ€ì… ì¶”ê°€, WorkPlan íƒ€ì… ì¶”ê°€ |
| `styles.css` | Chat ê´€ë ¨ ìŠ¤íƒ€ì¼ ì¶”ê°€, task-panelÂ·run-panel ìŠ¤íƒ€ì¼ deprecated |
| `BuildPromptBar.tsx` | Build ì™„ë£Œ í›„ Chatì— ì´ˆê¸° ë©”ì‹œì§€ ì‚½ì…í•˜ë„ë¡ ì—°ë™ |
| `KanbanView.tsx` | 5ì»¬ëŸ¼(+In Review), In Reviewâ†’Done ë“œë˜ê·¸ ì°¨ë‹¨, empty state ë©”ì‹œì§€ ë³€ê²½ |

### 7.3 ì‚­ì œ(ë˜ëŠ” deprecated) íŒŒì¼

| íŒŒì¼ | ì‚¬ìœ  |
|------|------|
| `panels/TaskPanel.tsx` | Chatìœ¼ë¡œ ì™„ì „ ëŒ€ì²´ |
| `panels/RunPanel.tsx` | Chat + TaskStatusCardë¡œ ëŒ€ì²´ |
| `panels/RunHistoryDetail.tsx` | Chat íˆìŠ¤í† ë¦¬ë¡œ ëŒ€ì²´ |
| `panels/InspectorVariables.tsx` | NodeContextCardë¡œ ëŒ€ì²´ |

---

## 8. Chat â†” Canvas ì—°ë™

### 8.1 Graph ë·° ì—°ë™

| ì´ë²¤íŠ¸ | Chat ë°˜ì‘ |
|--------|----------|
| ë…¸ë“œ í´ë¦­ | `node_context` ì¹´ë“œ ì‚½ì… (Agent ì´ë¦„, ì—­í• , Backend, ìƒíƒœ) |
| ë…¸ë“œ ë”ë¸”í´ë¦­ | AgentDetailModal (ê¸°ì¡´ ìœ ì§€, Chatê³¼ ë¬´ê´€) |
| Edge í´ë¦­ | `node_context` ì¹´ë“œ (Edge ì •ë³´ í‘œì‹œ) |
| +Agent ë²„íŠ¼ | Chatì— "ìƒˆ ì—ì´ì „íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤" ì•ˆë‚´, ëŒ€í™”ë¡œ ì„¤ì • ê°€ëŠ¥ |

### 8.2 Kanban ë·° ì—°ë™

#### Kanban ì»¬ëŸ¼ ë³€ê²½ (Review Gate ë°˜ì˜)

```
ê¸°ì¡´ Kanban 4ì»¬ëŸ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ Todo â”‚ In Progressâ”‚ Blocked â”‚ Done â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

ë³€ê²½ Kanban 5ì»¬ëŸ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ Todo â”‚ In Progressâ”‚ Blocked â”‚ In Review â”‚ Done â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                         Orchestrator ìŠ¹ì¸ í•„ìˆ˜
                         ìˆ˜ë™ ë“œë˜ê·¸ë¡œ Done ì´ë™ ë¶ˆê°€
```

**í•µì‹¬ ê·œì¹™**: `In Review â†’ Done` ì „í™˜ì€ **Orchestratorë§Œ** í•  ìˆ˜ ìˆë‹¤.
ì‚¬ìš©ìê°€ Kanbanì—ì„œ In Review ì¹´ë“œë¥¼ Doneìœ¼ë¡œ ë“œë˜ê·¸í•´ë„ **ê±°ë¶€**ë¨.
Orchestratorê°€ ê²€ì¦ í›„ ìŠ¹ì¸í•´ì•¼ë§Œ Doneìœ¼ë¡œ ì´ë™.

#### In Review ì¹´ë“œ í‘œì‹œ

```
â”Œâ”€ ğŸ” In Review â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                      â”‚
â”‚ ğŸ“‹ Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬               â”‚
â”‚ ğŸ‘¤ Frontend Dev (Codex)              â”‚
â”‚ â± ì œì¶œ ì‹œê°: 2ë¶„ ì „                  â”‚
â”‚                                      â”‚
â”‚ Orchestratorê°€ ê²°ê³¼ë¥¼ ê²€í†  ì¤‘...      â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ (ê²€ì¦ ì§„í–‰ ì¤‘)         â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Kanban â†” Chat ì´ë²¤íŠ¸

| ì´ë²¤íŠ¸ | Chat ë°˜ì‘ |
|--------|----------|
| Task ì¹´ë“œ í´ë¦­ | Chatì— í•´ë‹¹ Taskì˜ `task_status` ì¹´ë“œ í•˜ì´ë¼ì´íŠ¸ |
| Task ë“œë˜ê·¸ ì´ë™ | Chatì— "Task #3 ìƒíƒœë¥¼ Blocked â†’ In Progressë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤" |
| In Review â†’ Done ë“œë˜ê·¸ ì‹œë„ | **ê±°ë¶€** + Chatì— "Orchestrator ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤" ë©”ì‹œì§€ |
| Orchestrator ìŠ¹ì¸ | In Review â†’ Done ìë™ ì´ë™ + Chatì— ìŠ¹ì¸ ê²°ê³¼ ì¹´ë“œ |
| Orchestrator ìˆ˜ì •ìš”ì²­ | In Review â†’ In Progress ìë™ ì´ë™ + Chatì— í”¼ë“œë°± ì¹´ë“œ |
| Orchestrator ë°˜ë ¤ | In Review â†’ Todo ì´ë™ (ì¬í• ë‹¹) + Chatì— ë°˜ë ¤ ì‚¬ìœ  ì¹´ë“œ |
| Kanban ë¹ˆ ìƒíƒœ | "Chat íƒ­ì—ì„œ Orchestratorì—ê²Œ ì‘ì—…ì„ ì§€ì‹œí•˜ì„¸ìš”" |

### 8.3 Schedule ë·° ì—°ë™

| ì´ë²¤íŠ¸ | Chat ë°˜ì‘ |
|--------|----------|
| Schedule Task í´ë¦­ | Chatìœ¼ë¡œ ì „í™˜ + í•´ë‹¹ Task ë©”ì‹œì§€ ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤ |
| Now line ë„ë‹¬ | Chatì— "Task #2 ì˜ˆì • ì‹œê°„ì…ë‹ˆë‹¤. ì‹¤í–‰ì„ ì‹œì‘í•©ë‹ˆë‹¤." |

---

## 9. Orchestrator â€” ì‚´ì•„ìˆëŠ” í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €

> OrchestratorëŠ” "í•œ ë²ˆ ê³„íš ì„¸ìš°ê³  ë"ì´ ì•„ë‹ˆë‹¤.
> **í”„ë¡œì íŠ¸ê°€ ì‚´ì•„ìˆëŠ” ë™ì•ˆ ê³„ì† ê°ì‹œí•˜ê³ , íŒë‹¨í•˜ê³ , ê°œì…í•˜ëŠ” ì¡´ì¬**ë‹¤.

### 9.1 Orchestratorì˜ 6ê°€ì§€ ì±…ì„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ORCHESTRATOR                            â”‚
â”‚                                                           â”‚
â”‚  â‘  ì‚¬ìš©ì ëŒ€í™” ì°½êµ¬                                        â”‚
â”‚     Chatì—ì„œ ì‚¬ìš©ìì™€ ëŒ€í™” â†’ ì˜ë„ íŒŒì•… â†’ ì§ˆë¬¸/í™•ì¸          â”‚
â”‚                                                           â”‚
â”‚  â‘¡ Task ì„¤ê³„ & ë¶„ë°°                                       â”‚
â”‚     Workë¥¼ Taskë¡œ ë¶„í•´ â†’ Agent í• ë‹¹ â†’ Backend ê²°ì •         â”‚
â”‚                                                           â”‚
â”‚  â‘¢ Agent ê°ë… (Supervision)                               â”‚
â”‚     Agentê°€ ì¼í•˜ëŠ”ì§€ ê°ì‹œ â†’ ë©ˆì¶”ë©´ ì¬ì‹œì‘/ì¬í• ë‹¹            â”‚
â”‚                                                           â”‚
â”‚  â‘£ ê²°ê³¼ ê²€ì¦ & ìŠ¹ì¸ (Review Gate) â­ NEW                   â”‚
â”‚     Agent ê²°ê³¼ë¬¼ ê²€í†  â†’ ìŠ¹ì¸/ìˆ˜ì •ìš”ì²­/ë°˜ë ¤                  â”‚
â”‚     ìŠ¹ì¸ ì—†ì´ëŠ” Taskê°€ ì ˆëŒ€ "Done"ì´ ë  ìˆ˜ ì—†ìŒ             â”‚
â”‚                                                           â”‚
â”‚  â‘¤ ë¬¸ì œ ê°ì§€ & ë™ì  ëŒ€ì‘                                   â”‚
â”‚     ì‹¤íŒ¨/ë¸”ë¡/íƒ€ì„ì•„ì›ƒ ê°ì§€ â†’ ìƒˆ Task ìƒì„± or ì „ëµ ë³€ê²½     â”‚
â”‚                                                           â”‚
â”‚  â‘¥ í”„ë¡œì íŠ¸ ìƒíƒœ ë³´ê³                                       â”‚
â”‚     ì‚¬ìš©ìì—ê²Œ ì§„í–‰ ìƒí™© ìš”ì•½, ì™„ë£Œ ë³´ê³ , ë¹„ìš© ê²½ê³           â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 ì±…ì„ â‘ : ì‚¬ìš©ì ëŒ€í™” ì°½êµ¬

OrchestratorëŠ” Chatì˜ **ìœ ì¼í•œ ëŒ€í™” ìƒëŒ€**. ì‚¬ìš©ìëŠ” í•˜ìœ„ Agentì™€ ì§ì ‘ ëŒ€í™”í•˜ì§€ ì•ŠìŒ.

```
ì‚¬ìš©ì â†â”€â”€â”€â”€ Chat â”€â”€â”€â”€â†’ Orchestrator â†â”€â”€â”€â”€ dispatch â”€â”€â”€â”€â†’ Agentë“¤
                              â”‚
                        [ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸]
                        "ì–´ë–¤ DB ì“°ì„¸ìš”?"
                        "í…ŒìŠ¤íŠ¸ ë²”ìœ„ê°€ unitë§Œ?"
                        "ì´ íŒŒì¼ ê±´ë“œë ¤ë„ ë¼ìš”?"
```

**ëŒ€í™” íë¦„ (Planning ëª¨ë“œ)**:

```
1. ì‚¬ìš©ì: "ê²°ì œ ëª¨ë“ˆ ë§Œë“¤ì–´ì¤˜"
   â”‚
2. Orchestrator: (ë‚´ë¶€) ì˜ë„ ë¶„ì„ â†’ ì •ë³´ ë¶€ì¡± ê°ì§€
   â”‚
3. Orchestrator â†’ ì‚¬ìš©ì: "ëª‡ ê°€ì§€ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤:
   â”‚  - PGì‚¬ëŠ” ì–´ë””ë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”? (í† ìŠ¤, ì•„ì„í¬íŠ¸ ë“±)
   â”‚  - ì •ê¸°ê²°ì œë„ í•„ìš”í•œê°€ìš”?
   â”‚  - ê¸°ì¡´ ê²°ì œ ê´€ë ¨ ì½”ë“œê°€ ìˆë‚˜ìš”?"
   â”‚
4. ì‚¬ìš©ì: "í† ìŠ¤í˜ì´ë¨¼ì¸ , ì •ê¸°ê²°ì œ í•„ìš”, payments/ í´ë”ì— ìˆì–´"
   â”‚
5. Orchestrator: (ë‚´ë¶€) payments/ í´ë” ë¶„ì„ ì§€ì‹œ â†’ Agentì—ê²Œ
   â”‚
6. Orchestrator â†’ ì‚¬ìš©ì: "payments/ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.
   â”‚  ê¸°ì¡´ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ê³„íšì„ ì„¸ì› ìŠµë‹ˆë‹¤:"
   â”‚  [WorkPlan ì¹´ë“œ í‘œì‹œ]
   â”‚
7. ì‚¬ìš©ì: "ì§„í–‰í•´"
   â”‚
8. Orchestrator: Task ìƒì„± â†’ Agent í• ë‹¹ â†’ ì‹¤í–‰ ì‹œì‘
```

**í•µì‹¬**: OrchestratorëŠ” ì •ë³´ê°€ ë¶€ì¡±í•˜ë©´ **ë°˜ë“œì‹œ ì‚¬ìš©ìì—ê²Œ ë¬¼ì–´ë³¸ë‹¤**. ì¶”ì¸¡í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 9.3 ì±…ì„ â‘¡: Task ì„¤ê³„ & ë¶„ë°°

ì‚¬ìš©ìì˜ ìš”ì²­ì„ ë°›ìœ¼ë©´ Orchestratorê°€ ì§ì ‘ Taskë¥¼ ì„¤ê³„í•˜ê³  Agentì— ë¶„ë°°:

```typescript
interface TaskDesignResult {
  tasks: Array<{
    title: string;
    description: string;
    assignedAgentId: string;
    assignedBackend: Exclude<CliBackendId, "auto">;
    priority: "high" | "medium" | "low";
    deps: string[];             // ì„ í–‰ task ID
    estimateMs: number;
    requiredSkills: string[];   // Agentê°€ ê°€ì§„ Skill ì¤‘ ì´ Taskì— í•„ìš”í•œ ê²ƒ
  }>;

  // ì‚¬ìš©ìì—ê²Œ í™•ì¸í•  ì‚¬í•­
  questionsForUser?: string[];
}
```

**ë¶„ë°° ê¸°ì¤€**:
1. Agentì˜ **ì—­í• **(role)ê³¼ Taskì˜ ì„±ê²© ë§¤ì¹­
2. Agentì— í• ë‹¹ëœ **Skill** ë³´ìœ  ì—¬ë¶€
3. Agentì˜ í˜„ì¬ **ë¶€í•˜** (ë™ì‹œ ì‹¤í–‰ ì¤‘ì¸ Task ìˆ˜)
4. Backend **ì‚¬ìš©ëŸ‰ ì—¬ìœ ** (AGENT_TEAM_BUILD_SPEC ì°¸ì¡°)

### 9.4 ì±…ì„ â‘¢: Agent ê°ë… (Supervision Loop)

OrchestratorëŠ” Task í• ë‹¹ í›„ **ëë‚  ë•Œê¹Œì§€ ê°ì‹œ**í•œë‹¤. ì£¼ê¸°ì ìœ¼ë¡œ Agent ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” Supervision Loop ì‹¤í–‰:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SUPERVISION LOOP                     â”‚
â”‚              (ë§¤ Nì´ˆë§ˆë‹¤ ì‹¤í–‰)                      â”‚
â”‚                                                   â”‚
â”‚  for each activeTask:                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ Agent ì‘ë‹µ ìˆë‚˜? â”€â”€â”€â”€ Yes â†’ ì •ìƒ ì§„í–‰    â”‚    â”‚
â”‚    â”‚       â”‚                                 â”‚    â”‚
â”‚    â”‚      No                                 â”‚    â”‚
â”‚    â”‚       â”‚                                 â”‚    â”‚
â”‚    â”‚ íƒ€ì„ì•„ì›ƒ ì´ˆê³¼? â”€â”€â”€â”€ No â†’ ëŒ€ê¸° ê³„ì†       â”‚    â”‚
â”‚    â”‚       â”‚                                 â”‚    â”‚
â”‚    â”‚      Yes                                â”‚    â”‚
â”‚    â”‚       â”‚                                 â”‚    â”‚
â”‚    â”‚ â”Œâ”€ ê°œì… ê²°ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚    â”‚ â”‚ 1) Agentì— ping (ì¬ì‹œë„)            â”‚  â”‚    â”‚
â”‚    â”‚ â”‚ 2) Taskë¥¼ ë‹¤ë¥¸ Agentì— ì¬í• ë‹¹       â”‚  â”‚    â”‚
â”‚    â”‚ â”‚ 3) Taskë¥¼ ë‹¤ë¥¸ Backendë¡œ ì „í™˜       â”‚  â”‚    â”‚
â”‚    â”‚ â”‚ 4) ì‚¬ìš©ìì—ê²Œ ë³´ê³  (ìˆ˜ë™ ê°œì… ìš”ì²­)  â”‚  â”‚    â”‚
â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                   â”‚
â”‚  Agent ì‹¤í–‰ ì™„ë£Œ ì‹œ: (â†’ Review Gate ì§„ì…)           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ Task â†’ "in_review" ìƒíƒœ ì „í™˜             â”‚    â”‚
â”‚    â”‚ Kanban: In Review ì»¬ëŸ¼ìœ¼ë¡œ ì´ë™          â”‚    â”‚
â”‚    â”‚                                         â”‚    â”‚
â”‚    â”‚ Orchestrator ê²°ê³¼ ê²€ì¦ (Â§9.5):           â”‚    â”‚
â”‚    â”‚   â”œâ”€â”€ âœ… ìŠ¹ì¸ â†’ Task "done" + Chat ë³´ê³  â”‚    â”‚
â”‚    â”‚   â”œâ”€â”€ ğŸ”„ ìˆ˜ì •ìš”ì²­ â†’ Agentì— í”¼ë“œë°±       â”‚    â”‚
â”‚    â”‚   â”‚     â†’ "running" ë³µê·€ â†’ ì¬ì‘ì—…        â”‚    â”‚
â”‚    â”‚   â”‚     â†’ ì™„ë£Œ ì‹œ ë‹¤ì‹œ Review Gate       â”‚    â”‚
â”‚    â”‚   â”œâ”€â”€ âŒ ë°˜ë ¤ â†’ ë‹¤ë¥¸ Agentì— ì¬í• ë‹¹      â”‚    â”‚
â”‚    â”‚   â”‚     or ì‚¬ìš©ìì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜        â”‚    â”‚
â”‚    â”‚   â””â”€â”€ ë¶€ë¶„ ì™„ë£Œ â†’ í›„ì† Task ìë™ ìƒì„±    â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```typescript
interface SupervisionConfig {
  checkIntervalMs: number;        // ê°ì‹œ ì£¼ê¸° (ê¸°ë³¸ 5000ms)
  taskTimeoutMs: number;          // Taskë³„ íƒ€ì„ì•„ì›ƒ (ê¸°ë³¸ 300000ms = 5ë¶„)
  maxRetries: number;             // ìë™ ì¬ì‹œë„ íšŸìˆ˜ (ê¸°ë³¸ 2)
  escalateAfterRetries: boolean;  // ì¬ì‹œë„ ì´ˆê³¼ ì‹œ ì‚¬ìš©ìì—ê²Œ ë³´ê³ 
  autoReassign: boolean;          // ìë™ìœ¼ë¡œ ë‹¤ë¥¸ Agentì— ì¬í• ë‹¹
}
```

### 9.5 ì±…ì„ â‘£: ê²°ê³¼ ê²€ì¦ & ìŠ¹ì¸ (Review Gate) â­

> **í•µì‹¬ ì›ì¹™**: Agentê°€ Taskë¥¼ ì™„ë£Œí–ˆë‹¤ê³  ì œì¶œí•´ë„, Orchestratorê°€ ê²°ê³¼ë¥¼ ê²€ì¦í•˜ê³  ìŠ¹ì¸í•˜ê¸° ì „ê¹Œì§€ëŠ” **ì ˆëŒ€ "Done"ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.** Kanbanì—ì„œ "Done" ì»¬ëŸ¼ì— ë„ë‹¬í•˜ë ¤ë©´ ë°˜ë“œì‹œ Orchestratorì˜ ìŠ¹ì¸ì´ í•„ìš”.

#### Review Gate í”Œë¡œìš°

```
Agent: "Task #1 ì™„ë£Œí–ˆìŠµë‹ˆë‹¤" (proposal ì œì¶œ)
              â”‚
              â–¼
    â”Œâ”€â”€ Task ìƒíƒœ: "in_review" â”€â”€â”
    â”‚   Kanban: In Review ì»¬ëŸ¼    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    Orchestrator ìë™ ê²€ì¦ ì‹œì‘:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                 â”‚
    â”‚  1. ê²°ê³¼ë¬¼ ì¡´ì¬ í™•ì¸                              â”‚
    â”‚     - changedFilesì´ ë¹„ì–´ìˆì§€ ì•Šì€ê°€?             â”‚
    â”‚     - ì˜ˆìƒ deliverablesì´ ëª¨ë‘ ìˆëŠ”ê°€?            â”‚
    â”‚                                                 â”‚
    â”‚  2. ê¸°ë³¸ í’ˆì§ˆ ê²€ì¦                                â”‚
    â”‚     - ì½”ë“œ: ì»´íŒŒì¼/ë¦°íŠ¸ ì—ëŸ¬ ì—†ëŠ”ê°€?              â”‚
    â”‚     - í…ŒìŠ¤íŠ¸: ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ê¹¨ì§€ì§€ ì•Šì•˜ëŠ”ê°€?         â”‚
    â”‚     - íŒŒì¼: ì˜ˆìƒ ë²”ìœ„ ë°–ì˜ íŒŒì¼ ë³€ê²½ì´ ì—†ëŠ”ê°€?     â”‚
    â”‚                                                 â”‚
    â”‚  3. ìš”êµ¬ì‚¬í•­ ì¶©ì¡± í™•ì¸                            â”‚
    â”‚     - ì›ë˜ Task descriptionì˜ ìš”êµ¬ì‚¬í•­ ë§¤ì¹­        â”‚
    â”‚     - ë¹ ì§„ í•­ëª©ì´ ì—†ëŠ”ê°€?                         â”‚
    â”‚                                                 â”‚
    â”‚  4. ì˜ì¡´ Taskì™€ì˜ ì •í•©ì„± í™•ì¸                     â”‚
    â”‚     - ì„ í–‰ Task ê²°ê³¼ì™€ ì¶©ëŒí•˜ì§€ ì•ŠëŠ”ê°€?            â”‚
    â”‚     - í›„ì† Taskì— í•„ìš”í•œ outputì´ ìˆëŠ”ê°€?          â”‚
    â”‚                                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼           â–¼           â–¼
    âœ… ìŠ¹ì¸      ğŸ”„ ìˆ˜ì •ìš”ì²­    âŒ ë°˜ë ¤
         â”‚           â”‚           â”‚
    Taskâ†’"done"  í”¼ë“œë°± ì „ë‹¬   ì¬í• ë‹¹/ì—ìŠ¤ì»¬ë ˆì´ì…˜
    Kanban Done   Agent ì¬ì‘ì—…  ì‚¬ìš©ìì—ê²Œ ë³´ê³ 
    Chat ë³´ê³      Taskâ†’"running"
                  ì™„ë£Œâ†’ë‹¤ì‹œ Review
```

#### ê²€ì¦ ê¸°ì¤€ (ReviewCriteria)

```typescript
interface ReviewCriteria {
  // í•„ìˆ˜ ê²€ì¦ (ìë™)
  hasDeliverables: boolean;      // ê²°ê³¼ë¬¼ì´ ì¡´ì¬í•˜ëŠ”ê°€
  noCompileErrors: boolean;      // ì»´íŒŒì¼ ì—ëŸ¬ ì—†ëŠ”ê°€
  noTestRegressions: boolean;    // ê¸°ì¡´ í…ŒìŠ¤íŠ¸ í†µê³¼í•˜ëŠ”ê°€
  withinScope: boolean;          // ë³€ê²½ ë²”ìœ„ê°€ ì ì ˆí•œê°€

  // ì„ íƒ ê²€ì¦ (Task ì„¤ì •ì— ë”°ë¼)
  codeQualityScore?: number;     // 0~100, ë¦°íŠ¸/ë³µì¡ë„ ê¸°ë°˜
  testCoverage?: number;         // ìƒˆ ì½”ë“œì˜ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
  matchesDescription?: boolean;  // ìš”êµ¬ì‚¬í•­ ì¶©ì¡± ì—¬ë¶€

  // ìµœì¢… íŒì •
  autoApprovable: boolean;       // ìë™ ìŠ¹ì¸ ê°€ëŠ¥í•œê°€ (ëª¨ë“  í•„ìˆ˜ ê²€ì¦ í†µê³¼)
  confidence: number;            // 0~1, ê²€ì¦ ì‹ ë¢°ë„
}
```

#### ìë™ ìŠ¹ì¸ vs ìˆ˜ë™ ê²€í† 

```
ê²€ì¦ ê²°ê³¼ì— ë”°ë¥¸ ë¶„ê¸°:

ìë™ ìŠ¹ì¸ (confidence >= 0.9 && autoApprovable):
  â†’ "ê²€ì¦ ì™„ë£Œ. ìë™ ìŠ¹ì¸í•©ë‹ˆë‹¤." + ê²°ê³¼ ìš”ì•½
  â†’ Task â†’ "done" â†’ Kanban Done ì´ë™
  â†’ Chatì— âœ… ìŠ¹ì¸ ì¹´ë“œ í‘œì‹œ

ìˆ˜ë™ ê²€í†  í•„ìš” (confidence < 0.9 || !autoApprovable):
  â†’ Orchestratorê°€ ìƒì„¸ ê²€í†  ìˆ˜í–‰
  â†’ ê²€í†  ê²°ê³¼ì— ë”°ë¼ ìŠ¹ì¸/ìˆ˜ì •ìš”ì²­/ë°˜ë ¤

ì‚¬ìš©ì í™•ì¸ í•„ìš” (ì¤‘ìš”ë„ high + ëŒ€ê·œëª¨ ë³€ê²½):
  â†’ ì‚¬ìš©ìì—ê²Œ ìŠ¹ì¸ ìš”ì²­
  â†’ Chatì— "ì´ ê²°ê³¼ë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ì¹´ë“œ í‘œì‹œ
  â†’ [ìŠ¹ì¸] [ìˆ˜ì •ìš”ì²­] [ë°˜ë ¤] ë²„íŠ¼
```

#### Review ê²°ê³¼ë³„ Chat í‘œì‹œ

**âœ… ìŠ¹ì¸ ì‹œ:**
```
ğŸ¤– Orchestrator
Task #1 "Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬" ê²°ê³¼ë¥¼ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ âœ… Review ìŠ¹ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                           â”‚
â”‚ ê²€ì¦ ê²°ê³¼: í†µê³¼                            â”‚
â”‚ - ê²°ê³¼ë¬¼ ì¡´ì¬: âœ… 4ê°œ íŒŒì¼ ë³€ê²½             â”‚
â”‚ - ì»´íŒŒì¼ ì—ëŸ¬: âœ… ì—†ìŒ                     â”‚
â”‚ - í…ŒìŠ¤íŠ¸: âœ… 12/12 í†µê³¼                    â”‚
â”‚ - ìš”êµ¬ì‚¬í•­ ì¶©ì¡±: âœ…                        â”‚
â”‚                                           â”‚
â”‚ ì½”ë“œ í’ˆì§ˆ: 87/100                          â”‚
â”‚ [diff ë³´ê¸°]  [ìƒì„¸ ë³´ê³ ì„œ]                  â”‚
â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Task #1ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. âœ…
```

**ğŸ”„ ìˆ˜ì •ìš”ì²­ ì‹œ:**
```
ğŸ¤– Orchestrator
Task #2 "ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§" ê²°ê³¼ë¥¼ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ ğŸ”„ ìˆ˜ì • ìš”ì²­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚ ê²€ì¦ ê²°ê³¼: ìˆ˜ì • í•„ìš” (1ì°¨ ìˆ˜ì •)            â”‚
â”‚ - ê²°ê³¼ë¬¼ ì¡´ì¬: âœ…                         â”‚
â”‚ - ì»´íŒŒì¼ ì—ëŸ¬: âœ… ì—†ìŒ                    â”‚
â”‚ - í…ŒìŠ¤íŠ¸: âš ï¸ 2ê°œ ì‹¤íŒ¨                    â”‚
â”‚ - ìš”êµ¬ì‚¬í•­ ì¶©ì¡±: âš ï¸ ë¶€ë¶„ ì¶©ì¡±             â”‚
â”‚                                          â”‚
â”‚ í”¼ë“œë°±:                                   â”‚
â”‚ 1. auth.test.ts 2ê°œ ì¼€ì´ìŠ¤ ì‹¤íŒ¨           â”‚
â”‚ 2. refreshToken ë¡œì§ ëˆ„ë½                 â”‚
â”‚ 3. ì—ëŸ¬ í•¸ë“¤ë§ì— retry í•„ìš”               â”‚
â”‚                                          â”‚
â”‚ Backend Dev(Claude)ì—ê²Œ ìˆ˜ì • ì§€ì‹œ ì „ë‹¬...   â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ìˆ˜ì • í›„ ë‹¤ì‹œ ê²€ì¦í•©ë‹ˆë‹¤.
```

**âŒ ë°˜ë ¤ ì‹œ:**
```
ğŸ¤– Orchestrator
Task #3 "E2E í…ŒìŠ¤íŠ¸ ì‘ì„±" ê²°ê³¼ë¥¼ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ âŒ ë°˜ë ¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚ ê²€ì¦ ê²°ê³¼: ë°˜ë ¤                           â”‚
â”‚ - ê²°ê³¼ë¬¼ ì¡´ì¬: âš ï¸ í…ŒìŠ¤íŠ¸ íŒŒì¼ 1ê°œë§Œ       â”‚
â”‚ - í…ŒìŠ¤íŠ¸ ë²”ìœ„: âŒ ìš”êµ¬ 5ê°œ ì¤‘ 1ê°œë§Œ ì‘ì„±   â”‚
â”‚ - ì½”ë“œ í’ˆì§ˆ: 42/100                      â”‚
â”‚                                          â”‚
â”‚ ì‚¬ìœ : ìš”êµ¬ëœ E2E í…ŒìŠ¤íŠ¸ ë²”ìœ„ ë¯¸ì¶©ì¡±        â”‚
â”‚                                          â”‚
â”‚ ëŒ€ì‘:                                     â”‚
â”‚ â†’ QA Agent(Codex)ì—ì„œ ë‹¤ë¥¸ Agentë¡œ ì¬í• ë‹¹  â”‚
â”‚                                          â”‚
â”‚ [ì§ì ‘ í™•ì¸]  [ë‹¤ë¥¸ Agent ì§€ì •]  [ê±´ë„ˆë›°ê¸°] â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Reviewì™€ Kanban ìƒíƒœ ì „ì´ ë‹¤ì´ì–´ê·¸ë¨

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                      â”‚
  Todo â”€â”€â”€â”€â”€â†’ Running â”€â”€â”€â”€â”€â†’ In Review â”€â”€â”€â”€â”€â†’ Done         â”‚
   â”‚              â–²               â”‚ â”‚                      â”‚
   â”‚              â”‚               â”‚ â”‚   âœ… approved        â”‚
   â”‚              â”‚     ğŸ”„ revisionâ”‚ â”‚                      â”‚
   â”‚              â”‚     needed    â”‚ â”‚                      â”‚
   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                      â”‚
   â”‚                                â”‚   âŒ rejected        â”‚
   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
   â”‚     â”‚ (ì¬í• ë‹¹ ì‹œ ë‹¤ì‹œ Todo)                             â”‚
   â”‚     â–¼                                                 â”‚
   â””â”€â”€â”€â”€ Todo (ë‹¤ë¥¸ Agent í• ë‹¹)                             â”‚
                    â”‚                                      â”‚
                    â””â”€â”€â”€â”€ Blocked â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           (ë¬¸ì œ ë°œìƒ ì‹œ)
```

#### Review ê´€ë ¨ ë©”ì‹œì§€ í”„ë¡œí† ì½œ

```typescript
// Webview â†’ Extension
| RequestMessage<"TASK_REVIEW_OVERRIDE", {
    taskId: string;
    decision: TaskReviewDecision;
    feedback?: string;
  }>
// ì‚¬ìš©ìê°€ Orchestrator íŒë‹¨ì„ overrideí•˜ê³  ì§ì ‘ ìŠ¹ì¸/ë°˜ë ¤í•  ë•Œ

// Extension â†’ Webview
| { type: "TASK_REVIEW_RESULT"; payload: { review: TaskReviewResult } }
| { type: "TASK_REVIEW_STARTED"; payload: { taskId: string } }
```

#### maxRevisions â€” ë¬´í•œ ìˆ˜ì • ë°©ì§€

```typescript
interface ReviewGateConfig {
  autoApproveThreshold: number;    // ìë™ ìŠ¹ì¸ confidence ì„ê³„ê°’ (ê¸°ë³¸ 0.9)
  maxRevisions: number;            // ìµœëŒ€ ìˆ˜ì • íšŸìˆ˜ (ê¸°ë³¸ 3)
  requireUserApprovalFor: {
    highPriorityTasks: boolean;    // High ìš°ì„ ìˆœìœ„ TaskëŠ” ì‚¬ìš©ì í™•ì¸
    largeChanges: boolean;         // íŒŒì¼ 10ê°œ ì´ìƒ ë³€ê²½ ì‹œ ì‚¬ìš©ì í™•ì¸
    criticalPaths: string[];       // íŠ¹ì • ê²½ë¡œ ë³€ê²½ ì‹œ ì‚¬ìš©ì í™•ì¸
  };
  escalateOnMaxRevisions: boolean; // maxRevisions ì´ˆê³¼ ì‹œ ì‚¬ìš©ìì—ê²Œ ë³´ê³ 
}
```

maxRevisions ì´ˆê³¼ ì‹œ:
```
ğŸ¤– Orchestrator
Task #2 "ì¸ì¦ ë¡œì§ ë¦¬íŒ©í† ë§"ì´ 3íšŒ ìˆ˜ì • í›„ì—ë„ ê²€ì¦ì„ í†µê³¼í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ ğŸ”´ Review ì—ìŠ¤ì»¬ë ˆì´ì…˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚ ìˆ˜ì • íšŸìˆ˜: 3/3 (ìµœëŒ€ ë„ë‹¬)                â”‚
â”‚ ë¯¸í•´ê²° ì‚¬í•­:                              â”‚
â”‚ 1. refreshToken ë¡œì§ ì—¬ì „íˆ ë¯¸ì‘ë™         â”‚
â”‚ 2. í…ŒìŠ¤íŠ¸ 1ê°œ ì§€ì† ì‹¤íŒ¨                    â”‚
â”‚                                          â”‚
â”‚ [ì§ì ‘ ìˆ˜ì •]  [ë‹¤ë¥¸ Agent ì‹œë„]  [ê±´ë„ˆë›°ê¸°] â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.6 ì±…ì„ â‘¤: ë¬¸ì œ ê°ì§€ & ë™ì  Task/Agent ìƒì„±

OrchestratorëŠ” ì‹¤í–‰ ì¤‘ì—ë„ **ìƒˆë¡œìš´ Taskë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ , í•„ìš”í•˜ë©´ ìƒˆ Agentê¹Œì§€ ìƒì„±**í•œë‹¤:

| ìƒí™© | Orchestrator ëŒ€ì‘ |
|------|-------------------|
| Agent Aê°€ Task ì‹¤í–‰ ì¤‘ ì—ëŸ¬ ë°œìƒ | ì—ëŸ¬ ë¶„ì„ Task ìë™ ìƒì„± â†’ ë‹¤ë¥¸ Agent í• ë‹¹ |
| Task ì™„ë£Œ í›„ ê²°ê³¼ ê²€ì¦ ì‹¤íŒ¨ | ìˆ˜ì • Task ìë™ ìƒì„± (ì›ë˜ Agent ë˜ëŠ” ë‹¤ë¥¸ Agent) |
| ì„ í–‰ Task ê²°ê³¼ê°€ í›„ì† Task ë²”ìœ„ë¥¼ ë³€ê²½ | í›„ì† Task ì¬ì„¤ê³„ + ì‚¬ìš©ìì—ê²Œ ë³€ê²½ ì‚¬í•­ ë³´ê³  |
| Agentê°€ "ì¶”ê°€ ì‘ì—… í•„ìš”" ë³´ê³  | ì¶”ê°€ Task ìƒì„± + ì‚¬ìš©ìì—ê²Œ í™•ì¸ |
| Backend ì‚¬ìš©ëŸ‰ í•œë„ ê·¼ì ‘ | ë‚¨ì€ Taskì˜ Backend ì „í™˜ + ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ |
| ì˜ˆìƒ ì‹œê°„ ì´ˆê³¼ | ì‚¬ìš©ìì—ê²Œ ë³´ê³  + ê³„ì†/ì¤‘ë‹¨ í™•ì¸ |
| í˜„ì¬ íŒ€ì— ì í•©í•œ Agent ì—†ìŒ | **ìƒˆ Agent ìë™ ìƒì„±** + ì‚¬ìš©ìì—ê²Œ ë³´ê³  |
| ì‘ì—… ë²”ìœ„ê°€ ê¸°ì¡´ íŒ€ ì—­ëŸ‰ ì´ˆê³¼ | **ì „ë¬¸ Agent ì¶”ê°€ ìƒì„±** + íŒ€ í¸ì„± ë³€ê²½ |

#### ë™ì  Agent ìƒì„±

Orchestratorê°€ Taskë¥¼ ì„¤ê³„í•˜ë‹¤ê°€ "ì´ ì‘ì—…ì„ ì²˜ë¦¬í•  Agentê°€ íŒ€ì— ì—†ë‹¤"ê³  íŒë‹¨í•˜ë©´ **ì§ì ‘ Agentë¥¼ ë§Œë“ ë‹¤**:

```
ì‚¬ìš©ì: "DB ìŠ¤í‚¤ë§ˆë„ ë§ˆì´ê·¸ë ˆì´ì…˜í•´ì¤˜"

ğŸ¤– Orchestrator:
í˜„ì¬ íŒ€ì— DB ì „ë¬¸ Agentê°€ ì—†ìŠµë‹ˆë‹¤.

â”Œâ”€ ğŸ†• Agent ìƒì„± ì œì•ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                               â”‚
â”‚ ìƒˆ Agent: "DB Engineer"                       â”‚
â”‚ ì—­í• : coder (DB ì „ë¬¸)                         â”‚
â”‚ Backend: Codex (codex-1)                      â”‚
â”‚ Skills: schema-migration, sql-query           â”‚
â”‚ ì´ìœ : ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—…ì— ì „ë¬¸ Agent í•„ìš”       â”‚
â”‚                                               â”‚
â”‚ [ìƒì„± ë° ì§„í–‰]  [ì§ì ‘ ì„¤ì •]  [ê¸°ì¡´ Agent ì‚¬ìš©]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ìë™ ìƒì„± ì¡°ê±´**:
1. í˜„ì¬ íŒ€ì˜ ì–´ë–¤ Agentë„ í•´ë‹¹ Taskì˜ requiredSkillsì„ ì¶©ì¡±í•˜ì§€ ëª»í•  ë•Œ
2. ê¸°ì¡´ Agent ì „ë¶€ ê³¼ë¶€í•˜(ë™ì‹œ Task ìˆ˜ ì´ˆê³¼)ì¼ ë•Œ
3. íŠ¹ì • Backend/ëª¨ë¸ì´ í•„ìš”í•œë° í˜„ì¬ Agent ì¤‘ í•´ë‹¹ Backendì„ ì“°ëŠ” Agentê°€ ì—†ì„ ë•Œ

```typescript
/** Orchestrator ë‚´ë¶€: Agent ë¶€ì¡± ê°ì§€ â†’ ìë™ ìƒì„± */
async ensureAgentCapability(input: {
  requiredRole: AgentRole;
  requiredSkills: string[];
  requiredBackend?: Exclude<CliBackendId, "auto">;
  reason: string;
}): Promise<{
  action: "existing_agent" | "new_agent_proposed" | "new_agent_created";
  agentId: string;
  message: ChatMessage;  // ì‚¬ìš©ìì—ê²Œ ë³´ê³ 
}>;
```

**Chat í‘œì‹œ ì˜ˆì‹œ**:

```
ğŸ¤– Orchestrator
Task #2 "API ì—”ë“œí¬ì¸íŠ¸ ë¦¬íŒ©í† ë§" ì‹¤í–‰ ì¤‘ íƒ€ì… ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ âš ï¸ ë¬¸ì œ ê°ì§€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Dev (Claude)ê°€ auth.ts ìˆ˜ì • ì¤‘        â”‚
â”‚ TypeScript ì»´íŒŒì¼ ì—ëŸ¬ 3ê±´ ë°œìƒ                 â”‚
â”‚                                               â”‚
â”‚ ìë™ ëŒ€ì‘:                                     â”‚
â”‚ â†’ Task #2-fix "íƒ€ì… ì—ëŸ¬ ìˆ˜ì •" ìƒì„±            â”‚
â”‚ â†’ Backend Devì— í• ë‹¹ (ì¬ì‹œë„ 1/2)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
ğŸ¤– Orchestrator
Task #2-fix ì¬ì‹œë„ë„ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ ğŸ”´ ì—ìŠ¤ì»¬ë ˆì´ì…˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Dev (Claude)ê°€ 2íšŒ ì¬ì‹œë„ í›„ì—ë„        â”‚
â”‚ íƒ€ì… ì—ëŸ¬ë¥¼ í•´ê²°í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.                 â”‚
â”‚                                               â”‚
â”‚ ì„ íƒí•´ì£¼ì„¸ìš”:                                   â”‚
â”‚ [ë‹¤ë¥¸ Agentì— ì¬í• ë‹¹]  [ì§ì ‘ í™•ì¸]  [ê±´ë„ˆë›°ê¸°]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.7 ì‹¤í–‰ ì¤‘ ì‚¬ìš©ì ì§ˆì˜ (Mid-Execution Query) â­

> Task ê°œë°œ ë„ì¤‘ Agentê°€ ê²°ì •í•  ìˆ˜ ì—†ëŠ” ì •ë³´ê°€ í•„ìš”í•  ë•Œ, Orchestratorë¥¼ í†µí•´ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸í•˜ëŠ” ë¡œì§.
> AgentëŠ” ì‚¬ìš©ìì™€ ì§ì ‘ ëŒ€í™”í•˜ì§€ ì•ŠëŠ”ë‹¤. **ë°˜ë“œì‹œ Orchestratorë¥¼ ê±°ì¹œë‹¤.**

#### ì™œ í•„ìš”í•œê°€?

ì‹¤í–‰ ë‹¨ê³„ì—ì„œ í”íˆ ë°œìƒí•˜ëŠ” ìƒí™©:

| ìƒí™© | Agentê°€ ëª¨ë¥´ëŠ” ê²ƒ |
|------|------------------|
| DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ | "ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ë°©ì‹? í˜¸í™˜ì„± ìœ ì§€?" |
| API ì—°ë™ | "API í‚¤ëŠ”? ì¸ì¦ ë°©ì‹ì€? ì—”ë“œí¬ì¸íŠ¸ URL?" |
| UI êµ¬í˜„ | "ì´ ë²„íŠ¼ ìƒ‰ìƒ? ëª¨ë°”ì¼ì—ì„œ ë ˆì´ì•„ì›ƒ? í°íŠ¸?" |
| í…ŒìŠ¤íŠ¸ ì‘ì„± | "edge case ë²”ìœ„? mock ì„œë²„ ì‚¬ìš©?" |
| ë¦¬íŒ©í† ë§ | "ì´ ë ˆê±°ì‹œ í•¨ìˆ˜ ì‚­ì œí•´ë„ ë˜ëŠ”ì§€? ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°?" |
| ë°°í¬ ì„¤ì • | "í™˜ê²½ë³€ìˆ˜ ê°’? ìŠ¤í…Œì´ì§• vs í”„ë¡œë•ì…˜?" |
| ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ | "í• ì¸ìœ¨ ê¸°ì¤€? ì„¸ê¸ˆ ê³„ì‚° ë°©ì‹? ì˜ˆì™¸ ì²˜ë¦¬?" |

**Planning ë‹¨ê³„ì—ì„œ ë‹¤ ë¬¼ì–´ë³¼ ìˆ˜ ì—†ëŠ” ì´ìœ **: ì½”ë“œë¥¼ ì‹¤ì œë¡œ ë“¤ì—¬ë‹¤ë³´ê¸° ì „ì—ëŠ” ëª¨ë¥´ëŠ” ê²ƒë“¤ì´ ìˆë‹¤.

#### ì „ì²´ íë¦„

```
Agent â”€â”€â”€â”€â”€â”€ info_request â”€â”€â”€â”€â”€â”€â†’ Orchestrator
  (Task ì¼ì‹œì •ì§€ if blocking)        â”‚
                                     â”‚
                               [1ë‹¨ê³„: ìì²´ íŒë‹¨]
                               Orchestratorê°€ ë‹µì„ ì•„ëŠ”ê°€?
                                     â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
                             Yes            No
                              â”‚              â”‚
                     [ì§ì ‘ ë‹µë³€ ì „ë‹¬]   [2ë‹¨ê³„: ì‚¬ìš©ìì—ê²Œ ì „ë‹¬]
                              â”‚              â”‚
                              â”‚         Chatì— ì§ˆë¬¸ ì¹´ë“œ í‘œì‹œ
                              â”‚         Task ìƒíƒœ: "blocked" or ê³„ì†
                              â”‚              â”‚
                              â”‚         ì‚¬ìš©ì ë‹µë³€
                              â”‚              â”‚
                              â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                     [ë‹µë³€ì„ Agentì— ì „ë‹¬]
                     info_response
                              â”‚
                     Agent ì‘ì—… ì¬ê°œ
```

#### Orchestrator ìì²´ ë‹µë³€ ê°€ëŠ¥ íŒë‹¨

Orchestratorê°€ **ì§ì ‘ ë‹µë³€**í•  ìˆ˜ ìˆëŠ” ê²½ìš°:
- ì´ì „ ëŒ€í™”ì—ì„œ ì‚¬ìš©ìê°€ ì´ë¯¸ ì–¸ê¸‰í•œ ì •ë³´ (chatHistory ê²€ìƒ‰)
- í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ìœ ì¶” ê°€ëŠ¥í•œ ì •ë³´ (ê¸°ì¡´ ì½”ë“œ, ì„¤ì • íŒŒì¼ ë“±)
- ë‹¤ë¥¸ Agentì˜ ì™„ë£Œëœ Task ê²°ê³¼ì—ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì •ë³´

Orchestratorê°€ ë‹µë³€í•  ìˆ˜ **ì—†ëŠ”** ê²½ìš° (ë°˜ë“œì‹œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬):
- ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì • (í• ì¸ ì •ì±…, ê°€ê²© ë“±)
- ì™¸ë¶€ ì‹œìŠ¤í…œ ì¸ì¦ ì •ë³´ (API í‚¤, ë¹„ë°€ë²ˆí˜¸)
- ë””ìì¸ ì„ í˜¸ë„ (ìƒ‰ìƒ, ë ˆì´ì•„ì›ƒ ë“±)
- ìœ„í—˜í•œ ë³€ê²½ì— ëŒ€í•œ í—ˆê°€ (ë°ì´í„° ì‚­ì œ, ìŠ¤í‚¤ë§ˆ ë³€ê²½ ë“±)

```typescript
/** Orchestrator ë‚´ë¶€: Agent ì§ˆë¬¸ ìˆ˜ì‹  ì‹œ íŒë‹¨ */
private async resolveAgentQuery(
  query: MidExecutionQuery
): Promise<{
  canAnswer: boolean;
  answer?: string;
  confidence: number;       // 0~1, ìì²´ ë‹µë³€ ì‹ ë¢°ë„
  source?: "chat_history" | "project_context" | "other_task_result";
}>;
```

ìì²´ ë‹µë³€ ì‹ ë¢°ë„ê°€ **0.8 ë¯¸ë§Œ**ì´ë©´ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬ (ìì‹ ì˜ ë‹µë³€ì„ ì œì•ˆìœ¼ë¡œ ì²¨ë¶€).

#### urgencyì— ë”°ë¥¸ Task ìƒíƒœ ë³€í™”

| urgency | Task ìƒíƒœ | Agent ë™ì‘ | ì‚¬ìš©ì ë¬´ì‘ë‹µ ì‹œ |
|---------|----------|-----------|---------------|
| `blocking` | **"blocked"** (ì¼ì‹œì •ì§€) | ë‹µë³€ ì˜¬ ë•Œê¹Œì§€ ì™„ì „ ëŒ€ê¸° | timeoutMs í›„ defaultAnswer ì‚¬ìš© or ì—ìŠ¤ì»¬ë ˆì´ì…˜ |
| `preferred` | "running" ìœ ì§€ | ë‹¤ë¥¸ ë¶€ë¶„ ë¨¼ì € ì§„í–‰, ë‹µë³€ ì˜¤ë©´ ë°˜ì˜ | defaultAnswer ì‚¬ìš©í•˜ê³  ê³„ì† |
| `optional` | "running" ìœ ì§€ | ì§ˆë¬¸ ë¬´ì‹œí•˜ê³  defaultAnswerë¡œ ì§„í–‰ | ìë™ìœ¼ë¡œ defaultAnswer ì ìš© |

#### Chat UI â€” ì§ˆë¬¸ ì¹´ë“œ

**blocking ì§ˆë¬¸ (Task ë©ˆì¶¤):**
```
ğŸ¤– Orchestrator
Task #2 "ê²°ì œ ëª¨ë“ˆ êµ¬í˜„" ì§„í–‰ ì¤‘ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.

â”Œâ”€ â“ Agent ì§ˆë¬¸ (Task ì¼ì‹œì •ì§€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                â”‚
â”‚ ğŸ“‹ Task: ê²°ì œ ëª¨ë“ˆ êµ¬í˜„                         â”‚
â”‚ ğŸ‘¤ Agent: Backend Dev (Claude)                  â”‚
â”‚ ğŸ”´ Taskê°€ ì´ ë‹µë³€ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤            â”‚
â”‚                                                â”‚
â”‚ "í† ìŠ¤í˜ì´ë¨¼ì¸  APIë¥¼ ì—°ë™í•˜ë ¤ë©´ secretKeyê°€        â”‚
â”‚  í•„ìš”í•©ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ìš© í‚¤ë¥¼ ì•Œë ¤ì£¼ì‹œê² ì–´ìš”?         â”‚
â”‚  ì•„ë‹ˆë©´ .env íŒŒì¼ì— ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆë‚˜ìš”?"        â”‚
â”‚                                                â”‚
â”‚ [.envì— ìˆì–´]  [í‚¤ ì•Œë ¤ì¤„ê²Œ]  [ê±´ë„ˆë›°ê¸°]          â”‚
â”‚                                                â”‚
â”‚ â± ë‹µë³€ ëŒ€ê¸° ì¤‘... (ìë™ íƒ€ì„ì•„ì›ƒ: 60ì´ˆ)           â”‚
â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**preferred ì§ˆë¬¸ (Task ê³„ì† ì§„í–‰):**
```
ğŸ¤– Orchestrator
Task #1 "Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬" ì§„í–‰ ì¤‘ ì„ í˜¸ë„ í™•ì¸ì…ë‹ˆë‹¤.

â”Œâ”€ ğŸ’¬ Agent ì§ˆë¬¸ (ì§„í–‰ ì¤‘) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                â”‚
â”‚ ğŸ“‹ Task: Login ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬                    â”‚
â”‚ ğŸ‘¤ Agent: Frontend Dev (Codex)                  â”‚
â”‚ ğŸŸ¡ ë‹µë³€ ì—†ì–´ë„ ì§„í–‰ ê°€ëŠ¥ (ê¸°ë³¸ê°’ ì‚¬ìš©)            â”‚
â”‚                                                â”‚
â”‚ "ë¡œê·¸ì¸ í¼ validationì— ì‹¤ì‹œê°„ ê²€ì¦ì„             â”‚
â”‚  ì¶”ê°€í• ê¹Œìš”? (ì…ë ¥í•˜ë©´ì„œ ë°”ë¡œ ì—ëŸ¬ í‘œì‹œ)           â”‚
â”‚  ì•„ë‹ˆë©´ Submit ì‹œì ì—ë§Œ ê²€ì¦í• ê¹Œìš”?"              â”‚
â”‚                                                â”‚
â”‚ ì œì•ˆ: [ì‹¤ì‹œê°„ ê²€ì¦ (ì¶”ì²œ)]  [Submit ì‹œ ê²€ì¦]      â”‚
â”‚                                                â”‚
â”‚ ğŸ’¡ ë‹µë³€ ì—†ìœ¼ë©´ "ì‹¤ì‹œê°„ ê²€ì¦"ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤        â”‚
â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Orchestratorê°€ ëŒ€ì‹  ë‹µë³€í•œ ê²½ìš°:**
```
ğŸ¤– Orchestrator
Task #3ì—ì„œ ì§ˆë¬¸ì´ ì™”ëŠ”ë°, ì´ì „ ëŒ€í™”ì—ì„œ ì´ë¯¸ ë‹µì´ ìˆì–´ì„œ ì œê°€ ì „ë‹¬í–ˆìŠµë‹ˆë‹¤.

â”Œâ”€ ğŸ’¬ ìë™ ë‹µë³€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                â”‚
â”‚ ğŸ‘¤ QA Agent (Codex)ì˜ ì§ˆë¬¸:                      â”‚
â”‚ "í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ëŠ” ë­˜ ì“°ë‚˜ìš”?"                   â”‚
â”‚                                                â”‚
â”‚ ğŸ¤– Orchestrator ë‹µë³€ (ëŒ€í™” ê¸°ë¡ ê¸°ë°˜):            â”‚
â”‚ "ì•ì„œ ì‚¬ìš©ìê°€ Vitestë¥¼ ì‚¬ìš©í•œë‹¤ê³  ë§ì”€í•˜ì…¨ìŠµë‹ˆë‹¤" â”‚
â”‚                                                â”‚
â”‚ [ë§ì•„]  [ì•„ë‹ˆ, ë‹¤ë¥¸ ê±° ì¨]                        â”‚
â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë³µìˆ˜ ì§ˆë¬¸ íì‰

ì—¬ëŸ¬ Agentê°€ ë™ì‹œì— ì§ˆë¬¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì§ˆë¬¸ íê°€ í•„ìš”:

```typescript
interface QueryQueue {
  pending: MidExecutionQuery[];       // ì‚¬ìš©ì ë‹µë³€ ëŒ€ê¸° ì¤‘
  resolved: MidExecutionQuery[];      // ë‹µë³€ ì™„ë£Œ
  autoResolved: MidExecutionQuery[];  // Orchestratorê°€ ìë™ ë‹µë³€

  // í ê´€ë¦¬
  enqueue(query: MidExecutionQuery): void;
  dequeue(queryId: string): MidExecutionQuery | undefined;
  getBlockingQueries(): MidExecutionQuery[];  // blockingë§Œ í•„í„°
  getNextPending(): MidExecutionQuery | undefined;
}
```

Chat UIì—ì„œëŠ” **blocking ì§ˆë¬¸ì„ ë¨¼ì €** í‘œì‹œí•˜ê³ , preferred/optionalì€ ì ‘ì„ ìˆ˜ ìˆëŠ” í˜•íƒœ:

```
â”Œâ”€ â“ ë‹µë³€ í•„ìš” (2ê±´) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                               â”‚
â”‚ ğŸ”´ Task #2: "API í‚¤ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”" (blocking)   â”‚
â”‚ ğŸŸ¡ Task #1: "ì‹¤ì‹œê°„ ê²€ì¦?" (optional)          â”‚
â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Kanban ì—°ë™

blocking ì§ˆë¬¸ì´ ë°œìƒí•˜ë©´ Kanbanì—ì„œë„ í•´ë‹¹ Task ì¹´ë“œì— í‘œì‹œ:

```
â”Œâ”€ ğŸŸ¡ Blocked â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚ ğŸ“‹ ê²°ì œ ëª¨ë“ˆ êµ¬í˜„                         â”‚
â”‚ ğŸ‘¤ Backend Dev (Claude)                  â”‚
â”‚ â“ ì‚¬ìš©ì ë‹µë³€ ëŒ€ê¸° ì¤‘                    â”‚
â”‚                                          â”‚
â”‚ "í† ìŠ¤í˜ì´ë¨¼ì¸  API secretKey?"             â”‚
â”‚ [Chatì—ì„œ ë‹µë³€í•˜ê¸°]                       â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Kanban ì¹´ë“œì˜ **[Chatì—ì„œ ë‹µë³€í•˜ê¸°]** í´ë¦­ â†’ Chat íŒ¨ë„ ì „í™˜ + í•´ë‹¹ ì§ˆë¬¸ ì¹´ë“œë¡œ ìŠ¤í¬ë¡¤.

### 9.8 ì±…ì„ â‘¥: í”„ë¡œì íŠ¸ ìƒíƒœ ë³´ê³ 

OrchestratorëŠ” **ë¬¼ì–´ë³´ì§€ ì•Šì•„ë„** ì¤‘ìš”í•œ ìƒíƒœ ë³€í™”ë¥¼ Chatì— ë³´ê³ :

| ì´ë²¤íŠ¸ | ë³´ê³  ë‚´ìš© |
|--------|----------|
| Task ì‹œì‘ | "Task #1 ì‹œì‘í•©ë‹ˆë‹¤. Frontend Dev(Codex)ê°€ ì‘ì—… ì¤‘..." |
| Task ì™„ë£Œ | "Task #1 ì™„ë£Œ. 4ê°œ íŒŒì¼ ë³€ê²½, 2ë¶„ 32ì´ˆ ì†Œìš”. [diff ë³´ê¸°]" |
| ì „ì²´ ì§„í–‰ë¥  ë³€ê²½ | "ì „ì²´ ì§„í–‰ë¥  67% (2/3 Task ì™„ë£Œ)" |
| ë¹„ìš© ê²½ê³  | "Claude ì¼ì¼ ì‚¬ìš©ëŸ‰ 80% ë„ë‹¬. ë‚¨ì€ TaskëŠ” Codexë¡œ ì „í™˜í• ê¹Œìš”?" |
| ì „ì²´ ì™„ë£Œ | "ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìš”ì•½: ... [ê²°ê³¼ ë³´ê¸°]" |
| ì˜ˆìƒ ì‹œê°„ ì´ˆê³¼ | "ì˜ˆìƒë³´ë‹¤ ì˜¤ë˜ ê±¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤. í˜„ì¬ Task #2ì—ì„œ ëŒ€ê¸° ì¤‘..." |

### 9.9 ëŒ€í™” ëª¨ë“œë³„ Orchestrator ë™ì‘

| ëª¨ë“œ | Orchestrator ë™ì‘ |
|------|-------------------|
| **Planning** (ê¸°ë³¸) | ì§ˆë¬¸ â†’ ê³„íš â†’ ì‚¬ìš©ì í™•ì¸ â†’ Task ìƒì„± â†’ ê°ë… â†’ ë³´ê³  |
| **Direct** | ì§ˆë¬¸ ìµœì†Œí™” â†’ ì¦‰ì‹œ Task ìƒì„± â†’ ê°ë… â†’ ë³´ê³  |
| **Review** | ë¶„ì„ë§Œ ìˆ˜í–‰ (Task ìƒì„± ì•ˆ í•¨), Agentì—ê²Œ ì½ê¸° ì „ìš© ë¶„ì„ ì§€ì‹œ |

### 9.10 ìì—°ì–´ ëª…ë ¹ ì¸ì‹

ëŒ€í™” ì¤‘ ìì—°ì–´ë¡œ ì œì–´ ê°€ëŠ¥:

| ì‚¬ìš©ì ë°œí™” | Orchestrator ë™ì‘ |
|------------|-------------------|
| "ì§„í–‰í•´" / "ì‹œì‘í•´" / "ã„±" | WorkPlan í™•ì • â†’ Task ìƒì„± â†’ ê°ë… ì‹œì‘ |
| "ë©ˆì¶°" / "ì¤‘ë‹¨" | ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  Task ì¤‘ì§€ |
| "2ë²ˆ priority high" | WorkPlan item ìˆ˜ì • |
| "3ë²ˆ Claudeë¡œ ë°”ê¿”" | Backend ì¬í• ë‹¹ |
| "ë‹¤ì‹œ í•´ì¤˜" | ë§ˆì§€ë§‰ WorkPlan ì¬ì‹¤í–‰ |
| "ê²°ê³¼ ë³´ì—¬ì¤˜" | ì™„ë£Œëœ Task diff í‘œì‹œ |
| "ì·¨ì†Œ" | WorkPlan/Run ì·¨ì†Œ |
| "ì§€ê¸ˆ ìƒíƒœ ì–´ë•Œ?" | ì „ì²´ ì§„í–‰ë¥  + Agentë³„ ìƒíƒœ ìš”ì•½ |
| "ì™œ ëŠë ¤?" | ë³‘ëª© ë¶„ì„ + ì›ì¸ ë³´ê³  |
| "ë¹„ìš© ì–¼ë§ˆì•¼?" | í˜„ì¬ Runì˜ ëˆ„ì  ë¹„ìš© í‘œì‹œ |

### 9.11 Extension ì¸¡ êµ¬í˜„

**íŒŒì¼**: `extension/src/services/chatOrchestrator.ts`

```typescript
export class ChatOrchestrator {

  private supervisionTimer?: NodeJS.Timeout;
  private readonly config: SupervisionConfig;

  // â”€â”€ ì‚¬ìš©ì ëŒ€í™” â”€â”€

  /** ì‚¬ìš©ì ë©”ì‹œì§€ ìˆ˜ì‹  â†’ ì˜ë„ ë¶„ì„ â†’ ì§ˆë¬¸/ê³„íš/ì‹¤í–‰ */
  async handleUserMessage(input: {
    content: string;
    mode: "planning" | "direct" | "review";
    backendId: Exclude<CliBackendId, "auto">;
    context: OrchestratorContext;
  }): Promise<ChatMessage[]>;

  /** ì‚¬ìš©ìì—ê²Œ ë¬¼ì–´ë³¼ ê²Œ ìˆëŠ”ì§€ íŒë‹¨ */
  private async analyzeInfoGaps(
    userRequest: string,
    existingContext: OrchestratorContext
  ): Promise<string[] | null>;  // null = ì¶©ë¶„í•¨, string[] = ì§ˆë¬¸ ëª©ë¡

  // â”€â”€ Task ì„¤ê³„ & ë¶„ë°° â”€â”€

  /** ìš”ì²­ì„ Taskë¡œ ë¶„í•´ */
  async designTasks(input: {
    request: string;
    agents: AgentProfile[];
    usageSummaries: BackendUsageSummary[];
    answeredQuestions: Record<string, string>;
  }): Promise<TaskDesignResult>;

  /** WorkPlan í™•ì • â†’ Task ìƒì„± + Run ì‹œì‘ + ê°ë… ì‹œì‘ */
  async confirmAndExecute(planId: string): Promise<{
    runId: string;
    taskIds: string[];
  }>;

  // â”€â”€ Agent ê°ë… â”€â”€

  /** Supervision Loop ì‹œì‘ */
  startSupervision(runId: string): void;

  /** Supervision Loop ì¤‘ì§€ */
  stopSupervision(runId: string): void;

  /** ê°œë³„ Task ìƒíƒœ ì ê²€ */
  private async checkTaskHealth(task: Task): Promise<{
    healthy: boolean;
    action?: "retry" | "reassign" | "escalate" | "create_fix_task";
    reason?: string;
  }>;

  /** Agentì— ping (ì‘ë‹µ í™•ì¸) */
  private async pingAgent(agentId: string): Promise<boolean>;

  // â”€â”€ ë¬¸ì œ ëŒ€ì‘ â”€â”€

  /** ì‹¤íŒ¨í•œ Task ìë™ ëŒ€ì‘ */
  async handleTaskFailure(input: {
    taskId: string;
    error: string;
    retryCount: number;
  }): Promise<{
    action: "retried" | "reassigned" | "escalated" | "fix_task_created";
    newTaskId?: string;
    message: ChatMessage;
  }>;

  /** ë™ì ìœ¼ë¡œ ìƒˆ Task ìƒì„± (ë¬¸ì œ í•´ê²°ìš©) */
  async createDynamicTask(input: {
    reason: string;
    parentTaskId: string;
    title: string;
    assignTo?: string;
  }): Promise<Task>;

  // â”€â”€ ë™ì  Agent ìƒì„± â”€â”€

  /** íŒ€ì— í•„ìš”í•œ ì—­ëŸ‰ì´ ë¶€ì¡±í•  ë•Œ Agent ìƒì„± */
  async ensureAgentCapability(input: {
    requiredRole: AgentRole;
    requiredSkills: string[];
    requiredBackend?: Exclude<CliBackendId, "auto">;
    reason: string;
  }): Promise<{
    action: "existing_agent" | "new_agent_proposed" | "new_agent_created";
    agentId: string;
    message: ChatMessage;
  }>;

  /** ê³¼ë¶€í•˜ ì‹œ ë™ì¼ ì—­í•  Agent ë³µì œ ìƒì„± */
  async scaleAgent(input: {
    templateAgentId: string;  // ë³µì œí•  ê¸°ì¡´ Agent
    reason: string;
  }): Promise<{ agentId: string; message: ChatMessage }>;

  // â”€â”€ ì‹¤í–‰ ì¤‘ ì‚¬ìš©ì ì§ˆì˜ (Mid-Execution Query) â”€â”€

  /** Agentë¡œë¶€í„° info_request ìˆ˜ì‹  â†’ ìì²´ íŒë‹¨ or ì‚¬ìš©ìì—ê²Œ ì „ë‹¬ */
  async handleAgentInfoRequest(input: {
    taskId: string;
    agentId: string;
    question: string;
    context: string;
    urgency: QueryUrgency;
    suggestedOptions?: string[];
    defaultAnswer?: string;
  }): Promise<{
    action: "auto_resolved" | "forwarded_to_user";
    answer?: string;
    queryId: string;
    message: ChatMessage;
  }>;

  /** Orchestrator ìì²´ ë‹µë³€ ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨ (ë‚´ë¶€) */
  private async resolveAgentQuery(
    query: MidExecutionQuery
  ): Promise<{
    canAnswer: boolean;
    answer?: string;
    confidence: number;
    source?: "chat_history" | "project_context" | "other_task_result";
  }>;

  /** ì‚¬ìš©ì ë‹µë³€ì„ Agentì— ì „ë‹¬ + Task ì¬ê°œ */
  async forwardUserAnswer(input: {
    queryId: string;
    answer: string;
  }): Promise<void>;

  /** ì§ˆë¬¸ í ê´€ë¦¬ */
  private queryQueue: QueryQueue;

  // â”€â”€ ê²°ê³¼ ê²€ì¦ & ìŠ¹ì¸ (Review Gate) â”€â”€

  /** Agentê°€ ê²°ê³¼ë¥¼ ì œì¶œí•˜ë©´ ìë™ í˜¸ì¶œ â€” ê²°ê³¼ë¬¼ ê²€ì¦ */
  async reviewTaskResult(input: {
    taskId: string;
    proposal: { changedFiles: string[]; proposalJson?: string };
    agentId: string;
  }): Promise<TaskReviewResult>;

  /** ê²€ì¦ ê¸°ì¤€ í‰ê°€ (ë‚´ë¶€) */
  private async evaluateReviewCriteria(
    taskId: string,
    changedFiles: string[],
  ): Promise<ReviewCriteria>;

  /** ìˆ˜ì • ìš”ì²­ ì „ë‹¬ â†’ Agentì— í”¼ë“œë°± + Task "running" ë³µê·€ */
  private async requestRevision(input: {
    taskId: string;
    agentId: string;
    feedback: string;
    revisionItems: string[];
  }): Promise<void>;

  /** ì‚¬ìš©ì override ì²˜ë¦¬ (ì‚¬ìš©ìê°€ ì§ì ‘ ìŠ¹ì¸/ë°˜ë ¤) */
  async handleUserReviewOverride(input: {
    taskId: string;
    decision: TaskReviewDecision;
    feedback?: string;
  }): Promise<TaskReviewResult>;

  // â”€â”€ ë³´ê³  â”€â”€

  /** í”„ë¡œì íŠ¸ ìƒíƒœ ìš”ì•½ ìƒì„± */
  async generateStatusReport(runId: string): Promise<ChatMessage>;

  /** ë¹„ìš© ë³´ê³  */
  async generateCostReport(runId: string): Promise<ChatMessage>;
}

interface OrchestratorContext {
  agents: AgentProfile[];
  activeRunId?: string;
  activeTasks: Task[];
  completedTasks: Task[];
  chatHistory: ChatMessage[];
  usageSummaries: BackendUsageSummary[];
}
```

### 9.12 Orchestrator â†” Agent í†µì‹ 

```
Orchestrator                          Agent (í•˜ìœ„)
    â”‚                                     â”‚
    â”‚â”€â”€ HandoffEnvelope (Task ì§€ì‹œ) â”€â”€â”€â”€â”€â†’â”‚
    â”‚   { intent, inputs, plan,           â”‚
    â”‚     constraints, deliverables }     â”‚
    â”‚                                     â”‚
    â”‚â†â”€â”€ progress update (0~1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                     â”‚
    â”‚â†â”€â”€ info_request (ì •ë³´ ìš”ì²­) â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â­ NEW
    â”‚   { question, context, urgency,    â”‚
    â”‚     suggestedOptions }             â”‚
    â”‚                                     â”‚
    â”‚   â”Œâ”€â”€ Orchestrator íŒë‹¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚   â”‚ ì§ì ‘ ë‹µë³€ ê°€ëŠ¥? â†’ ë‹µë³€ ì „ë‹¬    â”‚ â”‚
    â”‚   â”‚ ëª¨ë¥´ë©´? â†’ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸      â”‚ â”‚
    â”‚   â”‚ blocking? â†’ Task ì¼ì‹œì •ì§€     â”‚ â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                     â”‚
    â”‚â”€â”€ info_response (ë‹µë³€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  â­ NEW
    â”‚   { answer, answeredBy }           â”‚
    â”‚                                     â”‚
    â”‚â†â”€â”€ proposal (ê²°ê³¼ ì œì¶œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚   { changedFiles, proposalJson }    â”‚
    â”‚                                     â”‚
    â”‚â”€â”€ review decision â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚   { approved / revision_needed }    â”‚
    â”‚                                     â”‚
    â”‚   (ë¬¸ì œ ë°œìƒ ì‹œ)                     â”‚
    â”‚â†â”€â”€ error report â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                     â”‚
    â”‚â”€â”€ (ìë™) retry or reassign â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚(ë‹¤ë¥¸ Agent)
```

ê¸°ì¡´ `HandoffEnvelope`(types.tsì— ì´ë¯¸ ì •ì˜ë¨)ì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ë˜, Orchestratorê°€ **ê²°ê³¼ë¥¼ ê²€ì¦(review)**í•œ ë’¤ ìŠ¹ì¸/ìˆ˜ì • ìš”ì²­ì„ ê²°ì •.

Agentê°€ **ì‹¤í–‰ ë„ì¤‘ ì •ë³´ê°€ í•„ìš”í•˜ë©´** `info_request`ë¥¼ Orchestratorì— ë³´ë‚¸ë‹¤. Orchestratorê°€ íŒë‹¨í•´ì„œ ì§ì ‘ ë‹µë³€í•˜ê±°ë‚˜ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•œë‹¤.

---

## 10. Build Team â†’ Chat ì´ˆê¸° ë©”ì‹œì§€ ì—°ë™

### 10.1 Build ì™„ë£Œ ì‹œ

Build Promptì—ì„œ "Build Team" í´ë¦­ â†’ íŒ€ ìƒì„± ì™„ë£Œ í›„:

```typescript
// App.tsx â€” buildTeamFromPromptBar() ì™„ë£Œ ì‹œ
const initialMessages: ChatMessage[] = [
  {
    id: generateId(),
    role: "system",
    content: [{
      kind: "text",
      text: `íŒ€ "${structure.teamName}"ì´ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\n` +
            `${structure.agents.length}ëª…ì˜ Agentê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.`
    }],
    timestamp: Date.now()
  },
  {
    id: generateId(),
    role: "orchestrator",
    content: [{
      kind: "text",
      text: "ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”? ì‘ì—…ì„ ì„¤ëª…í•´ì£¼ì‹œë©´ ê³„íšì„ ì„¸ì›Œë“œë¦¬ê² ìŠµë‹ˆë‹¤."
    }],
    timestamp: Date.now()
  }
];

// Chat íŒ¨ë„ë¡œ ì „í™˜ + ì´ˆê¸° ë©”ì‹œì§€ ì‚½ì…
setPanelMode("chat");
setChatMessages(initialMessages);
```

### 10.2 íŒ€ ë¯¸êµ¬ì„± ì‹œ

Chat íŒ¨ë„ì— ì§„ì…í–ˆìœ¼ë‚˜ íŒ€ì´ ì—†ì„ ë•Œ:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  ì•„ì§ Agent íŒ€ì´ êµ¬ì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.     â”‚
â”‚                                         â”‚
â”‚  ì•„ë˜ í”„ë¡¬í”„íŠ¸ ë°”ì—ì„œ íŒ€ì„ êµ¬ì„±í•˜ê±°ë‚˜,     â”‚
â”‚  ì§ì ‘ ëŒ€í™”ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.          â”‚
â”‚                                         â”‚
â”‚  [íŒ€ êµ¬ì„±í•˜ê¸°]                           â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. CSS ì‹ ê·œ í´ë˜ìŠ¤

```css
/* Chat Panel */
.chat-panel { }
.chat-messages { }          /* ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ */
.chat-message { }           /* ê°œë³„ ë©”ì‹œì§€ */
.chat-message.user { }
.chat-message.orchestrator { }
.chat-message.system { }

/* Chat Input */
.chat-input-area { }
.chat-input-textarea { }
.chat-input-toolbar { }
.chat-mode-select { }
.chat-backend-select { }
.chat-send-button { }
.chat-attach-button { }

/* Work Plan Card */
.work-plan-card { }
.work-plan-item { }
.work-plan-item-agent { }
.work-plan-item-backend { }
.work-plan-item-priority { }
.work-plan-actions { }

/* Task Status Card */
.task-status-card { }
.task-status-progress { }
.task-status-progress-fill { }
.task-status-agent { }

/* Task Complete Card */
.task-complete-card { }
.task-complete-diff { }
.task-complete-actions { }

/* Node Context Card */
.node-context-card { }
.node-context-header { }
.node-context-details { }

/* File Diff Card */
.file-diff-card { }
.file-diff-line { }
.file-diff-add { }
.file-diff-del { }

/* Task Review Card */
.task-review-card { }
.task-review-card.approved { }            /* border-left: 3px solid #2fa184 */
.task-review-card.revision-needed { }     /* border-left: 3px solid #d4a11e */
.task-review-card.rejected { }            /* border-left: 3px solid #d95c4f */
.task-review-criteria { }
.task-review-criteria-item { }
.task-review-criteria-pass { }            /* color: #2fa184 */
.task-review-criteria-fail { }            /* color: #d95c4f */
.task-review-criteria-warn { }            /* color: #d4a11e */
.task-review-feedback { }
.task-review-actions { }

/* Kanban In Review Column */
.kanban-column.in-review { }
.kanban-column.in-review .kanban-column-header {
  /* ê²€ì¦ ì¤‘ í‘œì‹œ: Amber ê³„ì—´ */
}
.kanban-card.in-review { }
.kanban-card.in-review .review-badge { }  /* "ê²€í†  ì¤‘" ë±ƒì§€ */

/* Mid-Execution Query Card */
.query-card { }
.query-card.blocking { }                  /* border-left: 3px solid #d95c4f, ë¹¨ê°„ ê°•ì¡° */
.query-card.preferred { }                 /* border-left: 3px solid #d4a11e */
.query-card.optional { }                  /* border-left: 3px solid #4a87e8 */
.query-card-header { }
.query-card-question { }
.query-card-context { }
.query-card-options { }
.query-card-option-button { }
.query-card-timeout { }                   /* ë‹µë³€ ëŒ€ê¸° íƒ€ì´ë¨¸ */
.query-card-default-notice { }            /* "ë‹µë³€ ì—†ìœ¼ë©´ Xë¡œ ì§„í–‰" */
.query-card.auto-resolved { }             /* Orchestrator ìë™ ë‹µë³€: ì•½í•œ ë°°ê²½ìƒ‰ */
.query-card.auto-resolved .query-source { } /* "ëŒ€í™” ê¸°ë¡ ê¸°ë°˜" ì¶œì²˜ í‘œì‹œ */

/* Query Queue Summary */
.query-queue-summary { }                  /* ìƒë‹¨ ê³ ì • ë°°ë„ˆ */
.query-queue-summary .blocking-count { }  /* ë¹¨ê°„ ë±ƒì§€ */
.query-queue-summary .pending-count { }   /* ë…¸ë€ ë±ƒì§€ */

/* Kanban Blocked + Query */
.kanban-card.blocked-query { }            /* ì§ˆë¬¸ ëŒ€ê¸° ì¤‘ í‘œì‹œ */
.kanban-card.blocked-query .query-preview { }
.kanban-card.blocked-query .answer-in-chat { }  /* "Chatì—ì„œ ë‹µë³€í•˜ê¸°" ë§í¬ */
```

---

## 12. êµ¬í˜„ ìˆœì„œ

### Phase 1: Chat íŒ¨ë„ ê¸°ë³¸ (P0)

| # | ì‘ì—… | ì˜ˆìƒ |
|---|------|------|
| 1-1 | ChatMessage íƒ€ì… ì •ì˜ (protocol.ts ì–‘ìª½) | 1h |
| 1-2 | ChatPanel.tsx ê¸°ë³¸ êµ¬ì¡° (ë©”ì‹œì§€ ëª©ë¡ + ì…ë ¥ì°½) | 3h |
| 1-3 | ChatInput.tsx (í…ìŠ¤íŠ¸ ì…ë ¥, ëª¨ë“œ ì„ íƒ, Backend ì„ íƒ, ì „ì†¡) | 2h |
| 1-4 | ChatMessageList.tsx (ìŠ¤í¬ë¡¤, ìë™ ìŠ¤í¬ë¡¤, ë©”ì‹œì§€ ë Œë”ë§) | 2h |
| 1-5 | RightPanel.tsx íƒ­ ì¶•ì†Œ (library + chat) | 1h |
| 1-6 | App.tsx panelMode íƒ€ì… ë³€ê²½ + Chat state ì¶”ê°€ | 2h |

### Phase 2: WorkPlan & Task ìƒì„± (P0)

| # | ì‘ì—… | ì˜ˆìƒ |
|---|------|------|
| 2-1 | WorkPlan íƒ€ì… + WorkPlanCard.tsx | 3h |
| 2-2 | chatOrchestrator.ts â€” ë©”ì‹œì§€ â†’ WorkPlan ìƒì„± | 4h |
| 2-3 | workPlanService.ts â€” í™•ì • â†’ Task ë³€í™˜ | 3h |
| 2-4 | CHAT_SEND / WORK_PLAN_CONFIRM ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ | 2h |
| 2-5 | WorkPlan ì¹´ë“œ ë‚´ ìˆ˜ì •/í™•ì •/ì·¨ì†Œ ì¸í„°ë™ì…˜ | 2h |

### Phase 3: ì‹¤í–‰ ìƒíƒœ & Review Gate (P1)

| # | ì‘ì—… | ì˜ˆìƒ |
|---|------|------|
| 3-1 | TaskStatusCard.tsx (ì§„í–‰ë¥  ë°”, ì—ì´ì „íŠ¸ í‘œì‹œ) | 2h |
| 3-2 | TaskCompleteCard.tsx (diff ìš”ì•½, ì•¡ì…˜ ë²„íŠ¼) | 2h |
| 3-3 | TASK_STATUS_UPDATE â†’ Chat ë©”ì‹œì§€ ë³€í™˜ | 2h |
| 3-4 | Kanban 5ì»¬ëŸ¼ (+In Review), In Reviewâ†’Done ë“œë˜ê·¸ ì°¨ë‹¨ | 2h |
| 3-5 | reviewGate.ts â€” ê²€ì¦ ê¸°ì¤€ í‰ê°€, ìë™ìŠ¹ì¸ ë¡œì§ | 4h |
| 3-6 | TaskReviewCard.tsx (ìŠ¹ì¸/ìˆ˜ì •ìš”ì²­/ë°˜ë ¤ í‘œì‹œ + ì•¡ì…˜ ë²„íŠ¼) | 3h |
| 3-7 | chatOrchestrator.tsì— reviewTaskResult, requestRevision ë©”ì„œë“œ | 3h |
| 3-8 | TASK_REVIEW_RESULT ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ + Kanban ìƒíƒœ ì—°ë™ | 2h |
| 3-9 | Kanban/Schedule â†” Chat ì–‘ë°©í–¥ ì—°ë™ | 3h |
| 3-10 | MidExecutionQuery íƒ€ì… + QueryQueue êµ¬í˜„ | 2h |
| 3-11 | QueryCard.tsx (blocking/preferred/optional í‘œì‹œ + ì‘ë‹µ ë²„íŠ¼) | 3h |
| 3-12 | handleAgentInfoRequest + resolveAgentQuery (ìì²´ ë‹µë³€ íŒë‹¨) | 3h |
| 3-13 | TASK_USER_QUERY / TASK_QUERY_RESPOND ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ | 2h |
| 3-14 | Kanban blocked-query ì¹´ë“œ + "Chatì—ì„œ ë‹µë³€í•˜ê¸°" ë§í¬ | 1h |

### Phase 4: ê³ ë„í™” (P2)

| # | ì‘ì—… | ì˜ˆìƒ |
|---|------|------|
| 4-1 | NodeContextCard.tsx (Inspector ëŒ€ì²´) | 2h |
| 4-2 | FileDiffCard.tsx | 2h |
| 4-3 | Chat íˆìŠ¤í† ë¦¬ persist (ì„¸ì…˜ ê°„ ìœ ì§€) | 3h |
| 4-4 | ìì—°ì–´ ëª…ë ¹ íŒŒì„œ ("2ë²ˆ highë¡œ", "ë©ˆì¶°" ë“±) | 3h |
| 4-5 | TaskPanel.tsx, RunPanel.tsx, InspectorVariables.tsx ì‚­ì œ | 1h |
| 4-6 | styles.cssì—ì„œ ë¯¸ì‚¬ìš© ìŠ¤íƒ€ì¼ ì •ë¦¬ | 1h |

---

## 13. ê¸°ì¡´ ë¬¸ì„œ ì˜í–¥

| ë¬¸ì„œ | í•„ìš” ë³€ê²½ |
|------|----------|
| FRAMEWORK.md | Â§0 ìš©ì–´ì— "Chat", "WorkPlan" ì¶”ê°€ |
| WORKFLOW.md | Â§1.6 ì‹¤í–‰ íë¦„ â†’ Chat ê¸°ë°˜ìœ¼ë¡œ ì „ë©´ ê°œì • |
| UI.md | Â§2.3 Right Panel íƒ­ êµ¬ì¡° â†’ Library + Chat |
| UX.md | Â§10 REV-5 (Task/Run êµ¬ë¶„ ë¶ˆëª…í™•) â†’ Chat í†µí•©ìœ¼ë¡œ í•´ì†Œ |
| UI_REVISION_WORKORDER.md | TASK-3 (Task íƒ­ ì¶”ê°€) â†’ Chat íƒ­ìœ¼ë¡œ ëŒ€ì²´ |
| AGENT_TEAM_BUILD_SPEC.md | Build â†’ Chat ì´ˆê¸° ë©”ì‹œì§€ ì—°ë™ ì¶”ê°€ |

---

## 14. ì‚­ì œ/í•´ì†Œë˜ëŠ” ê¸°ì¡´ ì´ìŠˆ

| ì´ìŠˆ ID | ë‚´ìš© | í•´ì†Œ ë°©ë²• |
|---------|------|----------|
| USR-2 | Inspector ì‘ë™ ì•ˆ í•¨ | Inspector ì‚­ì œ, NodeContextCardë¡œ ëŒ€ì²´ |
| USR-5 | Task/Run ì°¨ì´ ë¶ˆëª…í™• | ë‘˜ ë‹¤ ì‚­ì œ, Chat í•˜ë‚˜ë¡œ í†µí•© |
| USR-7 | + ë²„íŠ¼ ì—­í•  ë¶ˆëª…í™• | Chatì—ì„œ ëŒ€í™”ë¡œ Agent ì¶”ê°€ |
| BUG-1 | runTaskFromPanel í™”ë©´ ì „í™˜ ë®ì–´ì“°ê¸° | TaskPanel ì‚­ì œë¡œ í•´ë‹¹ ì½”ë“œ ìì²´ ì‚¬ë¼ì§ |
| BUG-4 | Kanban empty state ë©”ì‹œì§€ | "Chatì—ì„œ ì‘ì—…ì„ ì§€ì‹œí•˜ì„¸ìš”"ë¡œ í†µì¼ |
| BUG-5 | "Team panel" ë ˆê±°ì‹œ ìš©ì–´ | Chat ê¸°ë°˜ ìš©ì–´ë¡œ ì „ë©´ êµì²´ |
| FLOW-2 | Inspector â†” ë…¸ë“œ ì„ íƒ ë¶ˆì•ˆì • | Inspector ì‚­ì œ, ë…¸ë“œ í´ë¦­ â†’ Chat ì¹´ë“œ |

---

## 15. 2ì°¨ ê°œì • â€” ë²„ê·¸ ìˆ˜ì • & ê¸°ëŠ¥ í™•ì¥ (2026-02-20)

> ì½”ë“œ ê²€ì¦ ê²°ê³¼ë¥¼ ë°˜ì˜í•œ ì¶”ê°€ ìŠ¤í™

### 15.1 í˜„ì¬ êµ¬í˜„ ê²€ì¦ ê²°ê³¼

| í•­ëª© | ìƒíƒœ | íŒŒì¼ | ë¹„ê³  |
|------|------|------|------|
| CHAT_SEND ë©”ì‹œì§€ íƒ€ì… | âœ… êµ¬í˜„ë¨ | `protocol.ts` line 800 | - |
| Library + Chat íƒ­ êµ¬ì¡° | âœ… êµ¬í˜„ë¨ | `RightPanel.tsx` line 112 | `normalizedMode` ì´ì§„ ë¶„ê¸° |
| WorkPlan ì¹´ë“œ ë Œë”ë§ | âœ… êµ¬í˜„ë¨ | `ChatMessageList.tsx` line 38 | WorkPlanCard ì»´í¬ë„ŒíŠ¸ |
| ì‚¬ìš©ì ë©”ì‹œì§€ ë¡œì»¬ ì¶”ê°€ | âŒ ë¯¸êµ¬í˜„ | `App.tsx` line 1717 | sendChatMessageì— í˜¸ì¶œ ì—†ìŒ |
| Orchestrator Backend ë™ê¸°í™” | âŒ ë¯¸êµ¬í˜„ | `App.tsx` line 136 | í•˜ë“œì½”ë”© "claude" |
| ìŠ¤íŠ¸ë¦¬ë° ì²­í¬ í‘œì‹œ | âœ… êµ¬í˜„ë¨ | `handleExtensionMessage` | `CHAT_STREAM_CHUNK` ì²˜ë¦¬ |

### 15.2 [BUG-2] sendChatMessage ìˆ˜ì • ìŠ¤í™

**íŒŒì¼:** `webview-ui/src/App.tsx`

í˜„ì¬ `sendChatMessage` (line 1717~1738)ì˜ ë‘ ê°€ì§€ ë²„ê·¸:

**ë²„ê·¸ A â€” ì‚¬ìš©ì ë©”ì‹œì§€ ë¯¸í‘œì‹œ:**
Extensionì´ CHAT_MESSAGEë¡œ ì—ì½”í•˜ì§€ ì•Šìœ¼ë©´ UIì— ì•„ë¬´ ê²ƒë„ ì•ˆ ë‚˜íƒ€ë‚¨.
â†’ ìˆ˜ì •: `requestToExtension` í˜¸ì¶œ ì „ `appendLocalChatMessage` ì¶”ê°€

**ë²„ê·¸ B â€” íŒ¨ë„ ê°•ì œ ì „í™˜:**
`setPanelMode("chat")` í˜¸ì¶œì´ Library ë·°ë¥¼ ë®ì–´ì”€.
â†’ ìˆ˜ì •: Chat íƒ­ì´ ì´ë¯¸ í™œì„± ìƒíƒœì¼ ë•Œë§Œ ì „í™˜ ìƒëµ, ë˜ëŠ” íƒ­ í—¤ë” ì˜êµ¬ í‘œì‹œ

```
sendChatMessage ìˆ˜ì • íë¦„:
1. appendLocalChatMessage("user", content)    â† ì¦‰ì‹œ í™”ë©´ í‘œì‹œ
2. requestToExtension("CHAT_SEND", ...)       â† ë¹„ë™ê¸° ì „ì†¡
3. Extension â†’ CHAT_MESSAGE ì´ë²¤íŠ¸ â†’ ì‘ë‹µ í‘œì‹œ
4. ì—ëŸ¬ ì‹œ appendLocalChatMessage("system", error)
```

### 15.3 [BUG-4] Orchestrator Backend Lock ìŠ¤í™

**í˜„ì¬ ë¬¸ì œ:** Chat Backendê°€ "claude"ë¡œ ê³ ì •ë˜ì–´ íŒ€ Orchestratorì˜ ì„¤ì •ê³¼ ë¬´ê´€í•˜ê²Œ ë™ì‘.

**ì„¤ê³„ ì›ì¹™:**
> íŒ€ì— Orchestratorê°€ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´, Chatì€ ë°˜ë“œì‹œ í•´ë‹¹ Orchestratorì™€ ë™ì¼í•œ Backendë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
> Orchestratorê°€ ì—†ê±°ë‚˜ runtimeì´ ë¯¸ì„¤ì •ì¸ ê²½ìš°ì—ë§Œ ì‚¬ìš©ìê°€ ììœ  ì„ íƒ ê°€ëŠ¥.

```
Orchestrator Backend ë™ê¸°í™” íë¦„:
snapshot ì—…ë°ì´íŠ¸ â†’ orchestratorAgent íƒìƒ‰ â†’ runtime.backendId ì½ê¸°
â†’ chatBackendId ì—…ë°ì´íŠ¸ â†’ ChatInput backend select disabled
```

### 15.4 [FEAT-6] í„°ë¯¸ë„ ìŠ¤íƒ€ì¼ ì±„íŒ… UI ìŠ¤í™

**ëª©í‘œ:** ì±„íŒ…ì°½ì´ CLI í„°ë¯¸ë„ê³¼ ë™ì¼í•œ ì¸í„°ë™ì…˜ ë°©ì‹ì„ ë³´ì—¬ì¤Œ

#### ë©”ì‹œì§€ í˜•ì‹

```
â¯ PR #42 ë¦¬ë·°í•´ì¤˜                            [ì‚¬ìš©ì â€” 11:32:01]
â—† PR #42 ë¶„ì„ ì¤‘... íŒŒì¼ ë³€ê²½ 15ê°œ ê°ì§€      [orchestrator â€” 11:32:03]
â—† Task 3ê°œ ìƒì„±:                             [orchestrator â€” 11:32:05]
  Â· PR ì½”ë“œ ë¦¬ë·° â†’ Backend Coder
  Â· ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± â†’ QA Tester
  Â· ê²°ê³¼ ì •ë¦¬ â†’ Orchestrator
â— [ì‹œìŠ¤í…œ] Backend: Claude Code / claude-sonnet-4-5-20250929
```

ì—­í• ë³„ í”„ë¦¬í”½ìŠ¤:
- `â¯` â€” ì‚¬ìš©ì ì…ë ¥ (ì²­ë¡ #7ec8e3)
- `â—†` â€” Orchestrator ì‘ë‹µ (ì—°ì´ˆë¡ #a8e6cf)
- `â—` â€” ì‹œìŠ¤í…œ ë©”ì‹œì§€ (íšŒìƒ‰ #888)

#### ìŠ¤íŠ¸ë¦¬ë° í‘œì‹œ
`CHAT_STREAM_CHUNK` ìˆ˜ì‹  ì¤‘ â†’ ë§ˆì§€ë§‰ ì¤„ì— `â–Œ` ì»¤ì„œ ë¸”ë§í¬, ì²­í¬ ì™„ë£Œ í›„ ì»¤ì„œ ì‚¬ë¼ì§

### 15.5 í„°ë¯¸ë„ UI CSS ìŠ¤í™

```css
.chat-messages {
  font-family: "JetBrains Mono", "SF Mono", "Fira Code", monospace;
  font-size: 13px;
  line-height: 1.6;
}
.term-line { display: flex; gap: 10px; padding: 2px 0; align-items: flex-start; }
.term-line.term-user         .term-prefix { color: #7ec8e3; }
.term-line.term-orchestrator .term-prefix { color: #a8e6cf; }
.term-line.term-system       .term-prefix { color: #888;    }
.term-body { flex: 1; white-space: pre-wrap; word-break: break-word; }
.term-timestamp { flex-shrink: 0; font-size: 10px; color: var(--fg-muted); opacity: 0.6; }
.term-cursor { display: inline-block; width: 8px; height: 1em; background: var(--accent); animation: blink 1s step-end infinite; }
@keyframes blink { 50% { opacity: 0; } }
```
